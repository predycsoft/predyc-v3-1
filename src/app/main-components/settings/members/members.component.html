
<div class="mgl03 mgt10">
    <app-search-input-box></app-search-input-box>
</div>
<div class="mgt10">
    <table mat-table [dataSource]="dataSource" matSort>

        <!-- Nombre Column -->
        <ng-container matColumnDef="displayName">
            <th mat-header-cell *matHeaderCellDef mat-sort-header> Nombre del usuario </th>
            <td mat-cell *matCellDef="let user"> 
                <div fxLayout="row" fxLayoutGap="20px" fxLayoutAlign=" center">
                    <img [src]="user.photoUrl" class="avatar2" alt=""
                        onerror="this.src='assets/images/default/default-user-image.jpg'">
                    <span>{{ user.displayName | titlecase }}</span>
                </div>
            </td>
        </ng-container>

        <!-- Email Column -->
        <ng-container matColumnDef="email">
            <th mat-header-cell *matHeaderCellDef mat-sort-header> Correo electrónico </th>
            <td mat-cell *matCellDef="let user">{{ user.email }}</td>
        </ng-container>

        <!-- Status Column -->
        <ng-container matColumnDef="status">
            <th mat-header-cell *matHeaderCellDef mat-sort-header> Estatus </th>
            <td mat-cell *matCellDef="let user"> {{ 'Activo (hardcodeado)' }} </td>
        </ng-container>

        <!-- Created Date Column -->
        <ng-container matColumnDef="createdDate">
            <th mat-header-cell *matHeaderCellDef mat-sort-header> Fecha de creación </th>
            <td mat-cell *matCellDef="let user">{{user.createdAt | date: 'dd/MM/yy'}}</td>
        </ng-container>

        <!-- Last edited. Column -->
        <ng-container matColumnDef="lastEdited">
            <th mat-header-cell *matHeaderCellDef mat-sort-header> Ult. Modificación </th>
            <!-- Chequear valor a mostrar -->
            <td mat-cell *matCellDef="let user"> 
                <div fxLayout="row" fxLayoutAlign="center center">
                    <span>{{user.lastConnection | date: 'dd/MM/yy'}}</span>
                </div>
            </td>
        </ng-container>

        <!-- Actions Column -->
        <ng-container matColumnDef="actions">
            <th mat-header-cell *matHeaderCellDef mat-sort-header> Acciones administrativas </th>
            <td mat-cell *matCellDef="let user">
                <div class="cursorPointer" fxLayout="row" fxLayoutAlign="space-between center" [matMenuTriggerFor]="options" (click)="$event.stopPropagation()">
                    <span style="color: var(--gray-7);" >{{user.role === "admin" ? "Administrador" : "Usuario estándar" }}</span>
                    <img [src]="icon.arrowDown" class="iconButton h32px makeGray" alt="">          
                </div>
                <mat-menu #options="matMenu" class="radius6 shadow16 pd0">
                    <div fxLayout="column" class="fw pd0">
                        <div mat-menu-item fxLayout="row" fxLayoutAlign=" center" fxLayoutGap="2rem" 
                            [ngClass]="user.role === 'admin' ? 'disableOption' : ''"
                            (click)="user.role === 'admin' ? null : transformUserToAdmin(user)">
                            <span class="pdl05 ft12 gray-10">Administrador</span>
                        </div> 
                        <div mat-menu-item fxLayout="row" fxLayoutAlign=" center" fxLayoutGap="2rem" 
                            [ngClass]="user.role === 'student' ? 'disableOption' : ''"
                            (click)="user.role === 'student' ? null : transformUserToStudent(user)">
                            <span class="pdl05 ft12 gray-10">Usuario estándar</span>
                        </div>
                    </div>
                </mat-menu>
            </td>
        </ng-container>

        <!-- Delete Column -->
        <ng-container matColumnDef="delete">
            <th mat-header-cell *matHeaderCellDef mat-sort-header></th>
            <td mat-cell *matCellDef="let user">                         
                <div fxLayout="row" fxLayoutAlign="center center" class="cursorPointer" (click)="onDeleteUser(user)">
                    <img [src]="icon.trash" class="h16px makeGray" alt="">
                </div> 
            </td>
        </ng-container>

        <tr mat-header-row *matHeaderRowDef="displayedColumns"></tr>
        <tr mat-row *matRowDef="let user; columns: displayedColumns;"></tr>

        <!-- Row shown when there is no matching data. -->
        <tr class="mat-row" *matNoDataRow>
            <td class="mat-cell" colspan="4">No se han encontrado usuarios para el criterio de busqueda</td>
        </tr>
    </table>
    
    <!-- [hidePageSize]="true"
    [pageSizeOptions]="[5, 10, 15]" -->
    <mat-paginator
        aria-label="Select page of users"
        ></mat-paginator>
</div>