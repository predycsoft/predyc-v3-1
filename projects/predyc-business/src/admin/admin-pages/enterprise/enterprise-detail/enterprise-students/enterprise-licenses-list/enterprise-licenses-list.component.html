<div class="">
  <div fxLayout="row" fxLayoutAlign=" center">
    <h6 class="ft16 ft500 mgt0 mgb0">Licencias</h6>
    <mat-icon
      (click)="addLicense()"
      class="mgl10 gray-5 cursorPointer ft20 linkIcon"
      >add_circle</mat-icon
    >
  </div>
  <div class="fw">
    <table mat-table [dataSource]="dataSource">
      <!-- Producto Column -->
      <ng-container matColumnDef="product">
        <th mat-header-cell *matHeaderCellDef class="ft14 centertext">
          Producto
        </th>
        <td mat-cell *matCellDef="let data" class="centertext ft12">
          {{ data.productName }}
        </td>
      </ng-container>

      <!-- Adquiridas Column -->
      <ng-container matColumnDef="acquired">
        <th mat-header-cell *matHeaderCellDef class="ft14 centertext">
          Adquiridas
        </th>
        <td mat-cell *matCellDef="let data" class="centertext ft12">
          {{ data.acquired }}
        </td>
      </ng-container>

      <!-- Licencias disponibles Column -->
      <ng-container matColumnDef="rotations">
        <th mat-header-cell *matHeaderCellDef class="ft14 centertext">
          Rotaciones
        </th>
        <td mat-cell *matCellDef="let data" class="centertext ft12">
          {{ data.rotations ? data.rotations : 0 }}
        </td>
      </ng-container>

      <!-- Licencias disponibles Column -->
      <ng-container matColumnDef="available">
        <th mat-header-cell *matHeaderCellDef class="ft14 centertext">
          Licencias disponibles
        </th>
        <td mat-cell *matCellDef="let data" class="centertext ft12">
          {{ data.available }}
        </td>
      </ng-container>
      <!-- Licencias disponibles Column -->
      <ng-container matColumnDef="availableRotations">
        <th mat-header-cell *matHeaderCellDef class="ft14 centertext">
          Rotaciones disponibles
        </th>
        <td mat-cell *matCellDef="let data" class="centertext ft12">
          {{ data.availableRotations }}
        </td>
      </ng-container>

      <!-- Licencias usadas Column -->
      <ng-container matColumnDef="inUse">
        <th mat-header-cell *matHeaderCellDef class="centertext ft14">
          Licencias usadas
        </th>
        <td mat-cell *matCellDef="let data" class="centertext ft12">
          {{ data.used }}
        </td>
      </ng-container>

      <!-- Licencias disponibles Column -->
      <ng-container matColumnDef="rotationsUsed">
        <th mat-header-cell *matHeaderCellDef class="ft14 centertext">
          Rotaciones usadas
        </th>
        <td mat-cell *matCellDef="let data" class="centertext ft12">
          {{ data.rotationsUsed ? data.rotationsUsed : 0 }}
        </td>
      </ng-container>

      <!-- currentPeriodStart Column -->
      <ng-container matColumnDef="start">
        <th mat-header-cell *matHeaderCellDef class="ft14 centertext">
          Inicio
        </th>
        <td mat-cell *matCellDef="let data" class="centertext ft12">
          {{ data.start | date : "dd-MM-yyyy" }}
        </td>
      </ng-container>

      <!-- Vigencia Column -->
      <ng-container matColumnDef="expiration">
        <th mat-header-cell *matHeaderCellDef class="ft14 centertext">Fin</th>
        <td mat-cell *matCellDef="let data" class="centertext ft12">
          {{ data.valid | date : "dd-MM-yyyy" }}
        </td>
      </ng-container>

      <!-- Status Column -->
      <ng-container matColumnDef="status">
        <th mat-header-cell *matHeaderCellDef class="ft13 centertext">
          <div
            class="cursorPointer"
            fxLayout="row"
            fxLayoutAlign=" center"
            [matMenuTriggerFor]="menu"
          >
            <span>Estatus</span>
            <mat-icon>expand_more</mat-icon>
          </div>
          <mat-menu #menu="matMenu" class="radius6 shadow16 pd0">
            <div fxLayout="column" class="pd0">
              <div
                mat-menu-item
                class="opcionMenu"
                fxLayout="row"
                fxLayoutAlign=" center"
                (click)="search('all')"
                [ngClass]="
                  status == 'all' ? 'backGray2 green-5 ft500' : 'gray-10'
                "
              >
                <span class="pdl05">Todos</span>
              </div>
              <div
                mat-menu-item
                class="opcionMenu"
                fxLayout="row"
                fxLayoutAlign=" center"
                (click)="search('active')"
                [ngClass]="
                  status == 'active' ? 'backGray2 green-5 ft500' : 'gray-10'
                "
              >
                <span class="pdl05">Activos</span>
              </div>
              <div
                mat-menu-item
                class="opcionMenu"
                fxLayout="row"
                fxLayoutAlign=" center"
                (click)="search('expired')"
                [ngClass]="
                  status == 'expired' ? 'backGray2 green-5 ft500' : 'gray-10'
                "
              >
                <span class="pdl05">
                  <div fxLayout="row" fxLayoutGap="6px" fxLayoutAlign=" center">
                    <span>Vencidos</span>
                    <div
                      fxLayout="row"
                      fxLayoutAlign="center center"
                      *ngIf="atLeastOneExpired"
                      [matTooltip]="
                        'Esta empresa tiene licencias vencidas por desactivar'
                      "
                    >
                      <mat-icon style="color: var(--red-5)">error</mat-icon>
                    </div>
                  </div>
                </span>
              </div>
            </div>
          </mat-menu>
        </th>
        <td mat-cell *matCellDef="let data" class="centertext ft12">
          <div fxLayout="row" fxLayoutGap="6px" fxLayoutAlign=" center">
            <div
              class="pdt03 pdb03 radius6 fw"
              [ngClass]="
                data.status == SubscriptionClass.STATUS_ACTIVE
                  ? 'backGreen2 green-5'
                  : 'backGray3 gray-5'
              "
            >
              {{ data.status }}
            </div>
            <div
              fxLayout="row"
              fxLayoutAlign="center center"
              *ngIf="data.showWarning"
              [matTooltip]="
                'Esta empresa tiene licencias vencidas por desactivar'
              "
            >
              <mat-icon style="color: var(--red-5)">error</mat-icon>
            </div>
          </div>
        </td>
      </ng-container>

      <tr mat-header-row *matHeaderRowDef="displayedColumns"></tr>
      <ng-container>
        <tr mat-row *matRowDef="let data; columns: displayedColumns"></tr>
      </ng-container>

      <!-- Row shown when there is no matching data. -->
      <tr class="mat-row" *matNoDataRow>
        <td class="mat-cell" colspan="10">AÃºn no existe ninguna licencia.</td>
      </tr>
    </table>
  </div>
</div>
