<div fxLayout="column" class="pd10" ngClass="containerPC" ngClass.lt-md="containerMobile" style="overflow-y: auto; max-height: 90vh;">

    <div fxLayout="row" class=" bg-web-primary text-white px-3 py-1 mgb10" fxLayoutAlign="space-between center" >
        <div class="  " style="margin-bottom: -15px !important;">
            <span class="ft16  ft600 gray-10">
                Detalle del curso inscrito
            </span>
            
        </div>
        <div class="  ">
            <img [src]="icon.close" class="h24px    cursorPointer" alt="" (click)="salir()"  style="margin-bottom: -10px;">
        </div>
    </div>
    <div class="grayLine mgt05" style=" margin-bottom: 12px;" > </div>


    <div fxLayout="row" fxLayoutAlign=" center" fxLayoutGap="1rem">
        <div>
            <img [src]="coursePhoto ? coursePhoto : 'assets/images/default/default-user-image.jpg'" class="avatar4" alt="" >
        </div>
        <div fxLayout="row" fxLayoutGap=".5rem" fxLayoutAlign=" center">
            <span class="gray-10 ft22 ft500 blue-5 underline">
                {{courseTitle | titlecase}}
            </span>
            <div fxLayoutAlign="center center">
                <mat-icon>keyboard_arrow_right</mat-icon>
            </div>
            <span class="gray-10 ft22 ft500 blue-5 underline">
                {{userName | titlecase}}
            </span>
        </div>
        
        <div fxLayoutAlign=" center" class="mgl10 pdt05" fxLayoutGap="2rem">
            <!-- <a *ngIf="inscrito.completado==true" href="https://predyc.com/certificado/{{inscrito.certificado}}"
                target="_blank" class="pdb03 ">
                <span class="chip backBlue5 ft500 gray-2 cursorPointer">
                    Link de certificado
                </span>
            </a> -->
        </div>
        
    </div>
    <div fxLayout="row" fxLayoutAlign="center center" class="mgt10" fxLayoutGap=".5rem">
        <span class="ft11 backGray2 radius20 gray-8 pdr05 pdl05">Id del curso: {{courseRef.id}}</span>
        <span class="ft11 backGray2 radius20 gray-8 pdr05 pdl05">Id del courseByStudent: {{courseByStudentRef.id}}</span>
    </div>
    <div *ngIf="!isActive">
        <span class="ft13 ft500 red-5">El estudiante no tiene este curso activo actualmente.</span>
    </div>

    <div>
        <table mat-table [dataSource]="dataSource">

            <ng-container matColumnDef="module">
                <th mat-header-cell *matHeaderCellDef class="ft15 centertext"> Módulo </th>
                <td mat-cell *matCellDef="let data" class="centertext ft13">
                    <div fxLayout="row" fxLayoutGap=".1rem" fxLayoutAlign="start center">
                        <span>{{ data.numero }}.</span>
                        <span>{{ data.titulo | titlecase }}</span>
                    </div>
                </td>
            </ng-container>

            <ng-container matColumnDef="completed">
                <th mat-header-cell *matHeaderCellDef class="ft15 centertext"> Completado </th>
                <td mat-cell *matCellDef="let data" class="centertext ft13">
                    <mat-icon *ngIf="data.completedClassesInsidemodule === data.classes.length" class="green-5">check</mat-icon>
                    <mat-icon *ngIf="data.completedClassesInsidemodule !== data.classes.length" class="red-5">close</mat-icon>
                </td>
            </ng-container>

            <ng-container matColumnDef="completedClasses">
                <th mat-header-cell *matHeaderCellDef class="ft15 centertext"> Clases completadas </th>
                <td mat-cell *matCellDef="let data" class="centertext ft13"> {{ data.completedClassesInsidemodule }} / {{ data.classes.length }} </td>
            </ng-container>

            <ng-container matColumnDef="actions">
                <th mat-header-cell *matHeaderCellDef class="ft15 centertext"> Detalles </th>
                <td mat-cell *matCellDef="let data" class="centertext ft13">
                    <mat-accordion>
                        <mat-expansion-panel>
                            <mat-expansion-panel-header>
                                <mat-panel-title>
                                    Clases del Módulo
                                </mat-panel-title>
                            </mat-expansion-panel-header>
                            <div fxLayout="column" fxLayoutGap="1rem">
                                <div *ngFor="let cls of data.classes" fxLayout="row" fxLayoutAlign="space-between center" >
                                    <div fxLayout="row" fxLayoutAlign="start center" fxLayoutGap="1rem" class="">
                                        <span>{{ cls.titulo }}</span>
                                    </div>
                                    <!-- <div fxLayout="row" fxLayoutAlign="start center" fxLayoutGap="1rem">
                                        
                                    </div> -->
                                    <div fxLayout="row" fxLayoutAlign="end center" fxLayoutGap="1rem">
                                        <button *ngIf="!cls.isCompleted" class="blueButton" (click)="classReady(cls)">Completar clase</button>
                                        <mat-icon *ngIf="cls.isCompleted" class="green-5">check_circle</mat-icon>
                                        <mat-icon *ngIf="!cls.isCompleted" class="red-5">cancel</mat-icon>
                                    </div>
                                </div>
                            </div>
                        </mat-expansion-panel>
                    </mat-accordion>
                </td>
            </ng-container>

            <tr mat-header-row *matHeaderRowDef="displayedColumns"></tr>
            <tr mat-row *matRowDef="let data; columns: displayedColumns;"></tr>

            <tr class="mat-row" *matNoDataRow>
                <td class="mat-cell" colspan="8">No se han encontrado suscripciones para el criterio de búsqueda</td>
            </tr>
        </table>

        <mat-paginator aria-label="Select page of subscriptions" [pageSize]="pageSize" [length]="totalLength"></mat-paginator>
    </div>

    <div *ngIf="coursebyStudentData.progress == 90">
        <span (click)="generarCertificado(createCertificate)" class="ft14 blue-5 cursorPointer">Generar certificado</span>
    </div>
</div>


    <!-- createCertificate -->
    <ng-template #createCertificate let-modal>
        <div class="modal-header bg-web-primary text-white px-3 py-1">
            <div fxLayout="row" fxLayoutAlign="space-between center" class="w-100">
              <div class="modal-title pd10" fxLayout="row" fxLayoutAlign="start center">
                <img [src]="icon.catalog" class="h18px pdr05" alt="">
                <span class="ft16 ft600 gray-10">Crear certificado - {{courseTitle | titlecase}}</span>
              </div>
              <img style="cursor: pointer;" [src]="icon.close" (click)="modal.dismiss('Cross click')" class="h20px" alt="">
            </div>
          </div>
        <div class="modal-body">
            <div fxLayout="row" class="fw">
                <form [formGroup]="formCertificado" class="fw">
                    <div class="form-group fw">
                        <label class="ft12 " >Calificación</label>
                        <input
                        [class.is-invalid]="formCertificado.controls['calificacion'].errors && showError"
                        formControlName="calificacion" type="number" min="70" max="100" class="form-control customInput2 radius6 " placeholder="Escriba la calificación">
                        <div class="invalid-feedback" *ngIf="formCertificado.controls['calificacion'].errors && showError"> 
                            Debe indicar la calificación
                        </div>
                    </div>
                    <div class="form-group fw">
                        <label class="ft12 " >Fecha</label>
                        <input
                        [class.is-invalid]="formCertificado.controls['fecha'].errors && showError"
                        [max]="maxDate"
                        formControlName="fecha" type="date" class="form-control customInput2 radius6 " placeholder="Escriba el título del curso aquí">
                        <div class="invalid-feedback" *ngIf="formCertificado.controls['fecha'].errors && showError"> 
                            Debe indicar la fecha
                        </div>
                    </div>
                </form>
            </div>
            <div fxLayout="row" fxLayoutAlign="end center" class="fw" >
                <button
                fxLayout="row"
                fxLayoutGap="0.625"
                fxLayoutAlign="center center"
                class="blueButton ft14 cursorPointer mgt10"
                (click)="saveCertificate()"
                style="border-radius: 24px !important;">
                Guardar certificado
                <img [src]="icon.save" class="h16px pdl05 makeWhite" alt="">
            </button>
                
            </div>

        </div>
    </ng-template>
  
  