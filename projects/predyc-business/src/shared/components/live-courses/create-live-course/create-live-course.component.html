<ng-container *ngIf="!formNewCourse">
    <div style="display: flex; justify-content: center; align-items: center; height: 100%;">
        <mat-spinner class="spinner-dark" diameter="50"></mat-spinner>
    </div>
</ng-container>

<ng-container *ngIf="formNewCourse">
    <div class="fw" class="fw fh backWhite radius10" fxLayout="column">    <div [ngClass]="true ? 'header--edit' : ''" fxLayout="row" fxLayoutAlign="space-between " class="header pdr20 pdl10">
        <div fxLayout="row" fxLayoutAlign="space-between center" class="fw fh pdt05 pdb05"  >
            <div fxLayout="row">
                <div *ngIf="formNewCourse?.get('title')?.value"  class="radius20 pdl10 pdr10 mgr10 pdt05 pdb05 backWhite ft14 fh pdl05  " fxLayout="row" fxLayoutGap="8px" fxLayoutAlign=" center">
                    <span class="input-box ft14" placeholder="Nombre del curso"  >{{formNewCourse?.get('title')?.value}}</span>
                </div>
                <ng-container *ngIf="formNewCourse">
                    <input (change)="changeBorrador($event)" type="checkbox"  [checked]="formNewCourse?.get('proximamente')?.value">
                    <label style="padding-top: 5px; padding-left: 5px; color:white">Borrador</label>
                </ng-container>
            </div>
            <div fxLayout="row" fxLayoutGap="10px" fxLayoutAlign=" center">
                <div class="radius20 pdl10 pdr10 pdt05 pdb05 backWhite ft14 cursorPointer" routerLink="/management/live"> 
                    Cancelar
                </div>
                <button fxLayout="row" fxLayoutGap="0.625" fxLayoutAlign="center center" class="blueButton ft14 cursorPointer" 
                (click)="saveDraftPre()" style="border-radius: 24px !important;">
                    Guardar Curso <img [src]="icon.save" class="h16px pdl05 makeWhite" alt="">
                </button>
            </div>
        </div>
    </div>
        <div class="fh">
            <mat-tab-group mat-stretch-tabs="false" class="swal-overlay pdt35 " (selectedTabChange)="onTabChange($event)" style="z-index: 2; position :fixed;  width: 97%;" >
                <mat-tab label="Contenido del Curso"  style="z-index: 2; position :fixed;" >
                    <ng-container >
                        <div fxLayout="row" class=" " fxLayoutGap=""  style="overflow-y: auto; height: 150% !important; width: 100%; ">
                            <!-- Informacion general del curso -->
                            <div *ngIf="formNewCourse" class="radius10 w-30 mgt15 mgb10 mgl10 shadowLight  " fxLayout="column" style="background-color: rgba(244, 244, 244, 0.362); height: fit-content;">
                                <form [formGroup]="formNewCourse" class="mgl10 mgt15 mgr10 mgb20">
                                    <div class="fw" fxLayoutAlign="space-between center" fxLayout="row">
                                        <div fxLayout="row" fxLayoutAlign="start center" fxLayoutGap=".5rem" class="">
                                            <img [src]="icon.presentationFile" class="makeBlue h20px" alt="">
                                            <span class="ft500 ft14 black " style="margin-top: 5px;">Informacion general del curso</span>
                                        </div>
                                    </div>
                                    <div class="form-group mgt08">
                                        <label class="ft12 ">Título</label>
                                        <input [class.is-invalid]="formNewCourse.controls['title'].errors && showErrorCurso" formControlName="title" type="text" 
                                        class="form-control customInput2 radius6 " placeholder="Escriba el título del curso aquí">
                                        <div class="invalid-feedback" *ngIf="formNewCourse.controls['title'].errors && showErrorCurso"> 
                                            Debe indicar el título del curso
                                        </div>
                                    </div>
                                    <div *ngIf=" mode === 'edit'" class="form-group mgt08">
                                        <label class="ft12">Enlace de la reunion:</label>
                                        <div class="input-group">
                                            <input [class.is-invalid]="formNewCourse.controls['meetingLink'].errors && showErrorCurso" formControlName="meetingLink" 
                                            type="text" class="form-control customInput2 radius6" placeholder="Escriba el URL del curso aquí">
                                        </div>
                                        <div class="invalid-feedback" *ngIf="formNewCourse?.controls['meetingLink']?.errors && showErrorCurso">
                                            Debe indicar el link de la reunion
                                        </div>
                                    </div> 
                                    <div *ngIf=" mode === 'edit'" class="form-group mgt08">
                                        <label class="ft12">Texto identificativo:</label>
                                        <div class="input-group">
                                            <input [class.is-invalid]="formNewCourse.controls['identifierText'].errors && showErrorCurso" formControlName="identifierText" 
                                            type="text" class="form-control customInput2 radius6" placeholder="Escriba el URL del curso aquí">
                                        </div>
                                        <div class="invalid-feedback" *ngIf="formNewCourse?.controls['identifierText']?.errors && showErrorCurso">
                                            Debe indicar el texto identificativo
                                        </div>
                                    </div>                                          
                                    <div class="ft12 form-group pdt10">
                                        <label>Descripción del curso</label>
                                        <textarea [class.is-invalid]="formNewCourse.controls['description'].errors && showErrorCurso" rows="3"  formControlName="description" 
                                        type="text" class="form-control ft12  customInput2" placeholder="Escriba la descripción del curso aquí" style="resize: none;"></textarea>
                                        <div class="invalid-feedback" *ngIf="formNewCourse.controls['description'].errors && showErrorCurso"> 
                                            Debe indicar la descripción del curso
                                        </div>
                                    </div>
                                    <div class="form-group pdt10">
                                        <label class="ft12 pdb05 ">Foto del curso</label>
                                        <div fxLayout="row" fxLayoutAlign="start end" >
                                            <!-- <button class="add-button">Adjuntar nueva</button> -->
                                            <input #cursoImage type="file" (change)="uploadCourseImage($event,'curso')" hidden accept="image/jpeg, image/png" />
                                            <!-- <div class="image-scroll">
                                                <img *ngFor="let imagen of imagenesCurso" (click)="seleccionarImagenCurso(imagen)" [src]="imagen" alt="Imagen seleccionada" class="image cursorPointer {{this.formNewCourse.get('imagen').value == imagen? 'img-active': ''}}">
                                            </div> -->
                                            <div class="image-scroll">
                                                <img *ngIf="formNewCourse.get('photoUrl').value" [src]="formNewCourse.get('photoUrl').value" alt="Imagen seleccionada" class="avatarSquare8 radius6">
                                            </div>
                                            <div *ngIf="mode !== 'edit' " class="fw">
                                                <button (click)="cursoImage.click()" class="grayButton pd03 radius6 ft12 ft500 h28px mgr10 gray-8" fxLayoutGap="0.625" >
                                                    <img [src]="icon.arrowUp" class="h16px pdr05" alt="">
                                                    Adjuntar imagen
                                                </button>
                                            </div>
                                        </div>
                                    </div>
                                    <div *ngIf="formNewCourse.controls['photoUrl'].errors && showErrorCurso" class="custom-invalid-feedback pdt05">
                                        Debe seleccionar o subir la imagen del curso
                                    </div>
                                    <div fxLayout="row" fxLayoutAlign=" center" class="mgt10 fw">
                                        <form class="fw">
                                            <mat-form-field class="example-full-width fw">
                                                <mat-label>Buscar Pilar</mat-label>
                                                <input type="text"
                                                    class="ft14 fw"   
                                                    placeholder="Seleccione uno"
                                                    aria-label="Number"
                                                    matInput
                                                    #autoTrigger="matAutocompleteTrigger"
                                                    [formControl]="pillarsForm"
                                                    [matAutocomplete]="autoPillars">
                                                <mat-autocomplete [displayWith]="getOptionTextPillar" #autoPillars="matAutocomplete" class="options">
                                                    <mat-option (click)="changePillar(option)" class="multiline-mat-option ft12" *ngFor="let option of filteredPillars | async" [value]="option">
                                                        <div fxLayout="row" fxLayoutAlign="space-between">
                                                            <div fxLayout="col" fxLayoutAlign="center center">
                                                                {{option.name | titlecase}}
                                                            </div>
                                                        </div>
                                                    </mat-option>
                                                    <mat-option (click)="createPillar()" class="multiline-mat-option" value="null">Crear nuevo pilar</mat-option>
                                                </mat-autocomplete>
                                            </mat-form-field>
                                        </form>
                                    </div>
                                    <div fxLayout="row" fxLayoutAlign=" center" class="fw">
                                        <div class="skills-container">
                                            <ng-container *ngFor="let skill of skillsCurso; let indexSkill = index">
                                                <div style="display: inline-block; margin-right: 5px; margin-bottom: 5px; margin-top: 5px;"
                                                class="skill-badge-complete ListHover radius10 backGray2  ft12 pdl08 pdr08 gray-8 mgt08">
                                                    {{skill.name}}
                                                    <img *ngIf=" mode !== 'edit' " style="cursor: pointer;" (click)="removeSkill(skill)" [src]="icon.close"  class="h16px makeGray"  alt="">
                                                </div>
                                            </ng-container>
                                            <div *ngIf=" mode !== 'edit' " class="pdb10"> 
                                                <div *ngIf=" (skillsCurso?.length < 3 && pillarsForm.value) " matTooltip="Agregar competencia"
                                                style="display: inline-block; margin-right: 5px; "(click)="crearCompetencia(modalCrearSkill)" class="backGray2 radius20  pdl03 pdr03  gray-8 " >
                                                    <img style="cursor: pointer;" [src]="icon.addBlue" class="h16px ft600 "  alt="">
                                                </div>
                                            </div>
                                        </div>
                                        <div *ngIf="formNewCourse.controls['skills'].errors && showErrorCurso" class="custom-invalid-feedback pdt05">
                                            Debe seleccionar al menos una competencia.
                                        </div>
                                    </div>
                                    <ng-container>
                                        <div fxLayout="row" fxLayoutAlign="center center" class="mgt05 fw">
                                            <div fxFlex="100">
                                                <form class="example-form">
                                                    <mat-form-field class="example-full-width fw">
                                                        <mat-label>Buscar Instructor</mat-label>
                                                        <input type="text" class="ft14 fw" placeholder="Seleccione uno" aria-label="Number" matInput 
                                                        #autoTrigger="matAutocompleteTrigger" [formControl]="instructoresForm" [matAutocomplete]="autoInstructores">
                                                        <mat-autocomplete [displayWith]="getOptionText" #autoInstructores="matAutocomplete" class="options">
                                                            <mat-option (click)="setInstructor(option)" class="multiline-mat-option" *ngFor="let option of filteredinstructores | async" [value]="option">
                                                            <div fxLayout="row" fxLayoutAlign="space-between">
                                                                <div fxLayout="col" fxLayoutAlign="center center" class="ft12">
                                                                {{option.nombre | titlecase}}
                                                                </div>
                                                            </div>
                                                            </mat-option>
                                                            <mat-option  (click)="createInstructor()" class="multiline-mat-option" value="null">Crear nuevo instructor</mat-option>
                                                        </mat-autocomplete>
                                                    </mat-form-field>
                                                </form>
                                                <!-- <div *ngIf="formNewCourse.controls['imagen_instructor'].errors && showErrorCurso" class="custom-invalid-feedback pdt05">
                                                    Debe seleccinar el instructor
                                                </div> -->
                                            </div>
                                        </div>
                                    </ng-container>
                                </form>
                            </div>
                            <!-- Contenido del curso -->
                            <div class="column w-70 mgr25 fh" fxLayoutGap="2rem" style="margin-bottom: 15px;" >
                                <div class=" mgt15  mgl10 fw" fxLayout="column">
                                    <div fxLayout="column" class=" radius10  shadowLight" style=" background-color:rgba(244, 244, 244, 0.362); margin-bottom: 50px !important; overflow-y: auto; max-height: 150vh;">
                                        <div>
                                            <div fxLayout="row" fxLayoutAlign="start center" fxLayoutGap=".5rem" class="mgl10 mgt15 mgr10">
                                                <img [src]="icon.document" class="makeBlue h20px" alt="">
                                                <span class="ft500 ft14 black " style="margin-top: 5px;">Contenido del curso - {{getDurationModuleCourse() | formatDuration}}</span>
                                            </div>
                                            <div class="pdl10 pdr10 pdt10 fw ">
                                                <div fxLayout="column" class="fw fh mgb20"> 
                                                    <!-- Sesiones -->
                                                    <!-- <div *ngFor="let modulo of modulos; let iModulo = index" class="{{modulo['isInvalid']? 'ContainerModuloInvalid' : 'ContainerModulo'}}"> -->
                                                    <div class="ContainerModulo">
                                                        <div fxLayout="row" fxLayoutAlign="space-between start" class="fw pd08">
                                                            <div fxLayout="row" fxLayoutGap="10px" class="fw">
                                                                <div class="ft500 ft13">Agrega las sesiones que conformarán el curso</div>
                                                            </div>
                                                        </div>  
                                                        <div>
                                                            <!-- Sesiones existentes -->
                                                            <div *ngFor="let session of liveCourseData?.sessions; trackBy: trackBySession; let iClase = index" fxLayout="row" class="fw">
                                                                <div *ngIf="!session?.activity?.autoGenerated" class="mgl10 mgt03 mgr10 fw"> <!-- What is activity.autoGenerated for ???? -->
                                                                    <div class="fw mgb10">
                                                                        <mat-accordion multi="false" class="fw">
                                                                            <mat-expansion-panel [ngClass]="{'ContainerClase': session['isInvalid']}" [disabled]="!session.title || session.type == 'lectura'" 
                                                                            [expanded]="session['expanded'] || session.type == 'video'" (opened)="closeOtherSessions(session)">   

                                                                                <mat-expansion-panel-header>
                                                                                    <mat-panel-title (click)="onPanelTitleClick($event)" fxLayout="row" fxLayoutAlign="space-between center">
                                                                                        
                                                                                        <div fxLayout="row" fxLayoutAlign="start center" fxLayoutGap="1.5rem">
                                                                                            <!-- <img [src]="icon[getIconClase(session.type)]" class="h18px pdr05" alt=""> -->
                                                                                            <div *ngIf="session.title && !session['editarTitulo']; then tituloPresenteClase; else ClaseSinTitulo"></div>
                                                                                            <ng-template #tituloPresenteClase>
                                                                                                <span (click)="session['editarTitulo'] = true; session['tituloTMP'] = session?.title; editarTituloSession(iClase)">
                                                                                                    {{ session.title }} - {{ session.duration | formatDuration }} 
                                                                                                    {{ mode === "edit" ? ' - ' + ( session['dateFormatted'] ? 'Inicia el ' + (session['dateFormatted'] | customDatetime) : 'Sin fecha' ) + ' - Disponible durante ' + session['weeksToKeep'] + ' sem.' : '' }}
                                                                                                </span>
                                                                                            </ng-template>
                                                                                            <ng-template #ClaseSinTitulo>
                                                                                                <input #inputRef class="inputInvisible" type="text" [(ngModel)]="session['tituloTMP']" (keydown.space)="preventDefault($event)" 
                                                                                                (keyup.enter)="preventDefault($event); confirmSessionTitleAndDuration(session)" placeholder="Escriba el título aquí" [disabled]="mode === 'edit'" >

                                                                                                <select *ngIf="mode !== 'edit'" [(ngModel)]="session['duration']" class="duration-select">
                                                                                                    <option *ngFor="let duration of durations" [ngValue]="duration.value">{{ duration.label }}</option>
                                                                                                </select>
                                                                                                  
                                                                                                <div *ngIf=" mode === 'edit' " fxLayout="row" fxLayoutAlign=" center" fxLayoutGap=".25rem" class="form-group">
                                                                                                    <label class="ft12 ft500" for="fecha-inicio">Fecha y hora: </label>
                                                                                                    <input type="datetime-local" id="fecha-inicio" class="form-control w225px" [(ngModel)]="session['dateFormatted']">
                                                                                                </div>

                                                                                                <div *ngIf=" mode === 'edit' " fxLayout="row" fxLayoutAlign=" center" fxLayoutGap=".25rem" class="">
                                                                                                    <label class="ft12 ft500" for="">Repetición: </label>
                                                                                                    <select class="duration-select" [(ngModel)]="session['weeksToKeep']">
                                                                                                        <option [ngValue]="2">2 Sem</option>
                                                                                                        <option [ngValue]="3">3 Sem</option>
                                                                                                        <option [ngValue]="4">4 Sem</option>
                                                                                                    </select>
                                                                                                </div>
                                                                                                <img (click)="confirmSessionTitleAndDuration(session)" matTooltip="Confirmar título" [src]="icon.check" 
                                                                                                class="h18px pdl05 makeGray edit cursorPointer" alt="">
                                                                                            </ng-template>

                                                                                        </div>

                                                                                        <div fxLayout="row" fxLayoutAlign="space-between center">

                                                                                            <ng-container *ngIf="mode === 'edit'">
                                                                                                <div *ngIf="!session.vimeoId1">
                                                                                                    <span (click)="FileInputTitle.click()" *ngIf=" session.title && !session['videoUpload'] && !session['uploading']" class="blueLink mgr10">
                                                                                                        Agregar video
                                                                                                    </span>
                                                                                                    <div *ngIf="session.type == 'video' && session['videoUpload']">
                                                                                                        <span *ngIf="session['videoUpload'] < 100 && session['videoUpload'] > 0" class="pdl05 mgr10">
                                                                                                            Subiendo video: {{session['videoUpload']}}%
                                                                                                        </span>
                                                                                                    </div>
                                                                                                    <span *ngIf="!session.title" class="gray-6 cursorPointer mgr10">Agregar video</span>
                                                                                                    <input (change)="session.type = 'video'; onFileSelected($event, session, false, false, null, true) " type="file" accept="video/mp4" #FileInputTitle style="display: none;">
                                                                                                </div>

                                                                                                <div *ngIf="session.vimeoId1" fxLayout="row" fxLayoutAlign="start center">
                                                                                                    <span (click)="quitarVideoSession(session)" class="blueLink mgr05">Eliminar</span>
                                                                                                    <button (click)="verVideoVimeo(session)" class="grayButton pd03 radius4 ft12 h28px mgr10 w130px" fxLayout="row" 
                                                                                                    fxLayoutGap="0.625" fxLayoutAlign="center center">
                                                                                                        <img [src]="icon.playOutline" class="h16px pdr05" alt="">
                                                                                                        Reproducir video
                                                                                                    </button>
                                                                                                </div>
                                                                                            </ng-container>

                                                                                            <!-- <ng-container *ngIf="session.type == 'video'">
                                                                                                <div *ngIf="!session.vimeoId1">
                                                                                                    <span (click)="FileInputTitle.click()" *ngIf=" mode === 'edit' && session.title && !session['videoUpload'] && !session['uploading']" class="blueLink mgr10">
                                                                                                        Agregar video
                                                                                                    </span>
                                                                                                    <div *ngIf="session.type == 'video' && session['videoUpload']">
                                                                                                        <span *ngIf="session['videoUpload'] < 100 && session['videoUpload'] > 0" class="pdl05 mgr10">
                                                                                                            Subiendo video: {{session['videoUpload']}}%
                                                                                                        </span>
                                                                                                    </div>
                                                                                                    <span *ngIf="!session.title && mode === 'edit' " class="gray-6 cursorPointer mgr10">Agregar video</span>
                                                                                                    <input (change)="onFileSelected($event, session, false) " type="file" accept="video/mp4" #FileInputTitle style="display: none;">
                                                                                                </div>
                                                                                                <div *ngIf="session.vimeoId1" fxLayout="row" fxLayoutAlign="start center">
                                                                                                    <span (click)="quitarVideoSession(session)" class="blueLink mgr05">Eliminar</span>
                                                                                                    <button (click)="verVideoVimeo(session)" class="grayButton pd03 radius4 ft12 h28px mgr10 w130px" fxLayout="row" 
                                                                                                    fxLayoutGap="0.625" fxLayoutAlign="center center">
                                                                                                        <img [src]="icon.playOutline" class="h16px pdr05" alt="">
                                                                                                        Reproducir video
                                                                                                    </button>
                                                                                                </div>
                                                                                            </ng-container>
                                                                                            <ng-container *ngIf="session.type == 'lectura'">
                                                                                                <div *ngIf="!session.vimeoId1">
                                                                                                    <span (click)="FileInputTitle.click()" *ngIf="session.title && !session['uploading'] && !session?.files[0]" class="blueLink mgr10">
                                                                                                        Agregar archivo
                                                                                                    </span>
                                                                                                    <div *ngIf="session?.files[0]?.uploading_file_progress">
                                                                                                        <span *ngIf="session.files[0].uploading_file_progress < 100" class="pdl05 mgr10">
                                                                                                            {{session.files[0].uploading_file_progress}}%
                                                                                                        </span>
                                                                                                    </div>
                                                                                                    <span *ngIf="!session.title" class="gray-6 mgr10">Agregar archivo</span>
                                                                                                    <input (change)="onFileSelected($event, session, false)" type="file" accept="lectura" #FileInputTitle style="display: none;">
                                                                                                </div>
                                                                                                <div *ngIf="session.files[0]" fxLayout="row" fxLayoutAlign="start center">
                                                                                                    <span (click)="deleteFileClass(session)" class="blueLink mgr05">Eliminar</span>
                                                                                                    <button (click)="descargarArchivo(session?.files[0])" class="grayButton pd03 radius4 ft12 h28px mgr10 w130px" fxLayout="row" 
                                                                                                    fxLayoutGap="0.625" fxLayoutAlign="center center">
                                                                                                        <img [src]="icon.pdf" class="h16px pdr05" alt="">Ver archivo
                                                                                                    </button>
                                                                                                </div>
                                                                                            </ng-container> -->
                                                                                            
                                                                                            <img *ngIf=" mode !== 'edit' " (click)="borrarSession(session)" [src]="icon.trash" class="h16px trash" alt="">
                                                                                        </div>
                                                                                    </mat-panel-title>
                                                                                </mat-expansion-panel-header>
                                                                                
                                                                                <!-- Contenido con sesion expandida -->

                                                                                <!-- si es de archivo es un drop -->
                                                                                <ng-container *ngIf="session.type != 'actividad' &&  session.type !='corazones'">
                                                                                    <!-- Lista de recursos de sesiones base -->
                                                                                    <ng-container>
                                                                                        <div *ngIf="!session['uploading'] && session.files.length > 0" class="fw ContainerFile" style="min-height: 80px;">
                                                                                            <div fxLayout="row" fxLayoutGap="20px" class="fw pd10" (dragover)="onDragOver($event)" (drop)="onDrop($event, session. type, session)">
                                                                                                <!-- Columna izquierda con el texto "Recursos:" -->
                                                                                                <div fxFlex="10%" fxLayoutAlign="start start">Recursos:</div>
                                                                                                <!-- Columna derecha con la lista de archivos -->
                                                                                                <div fxFlex="90%" fxLayoutAlign="start start">
                                                                                                    <ol style="padding-left: 10px; margin: 0;">
                                                                                                        <ng-container *ngFor="let archivo of session.files; let i = index">
                                                                                                            <!-- Lista los archivos comenzando desde el segundo elemento (índice 1) -->
                                                                                                            <li>
                                                                                                                <span class="cursorPointer blueLink" (click)="descargarArchivo(archivo)">{{ archivo.nombre }}</span>
                                                                                                                <img *ngIf="mode !== 'edit'" [src]="icon.close" class="h18px pdl10 makeRed cursorPointer" alt="" (click)="borrarArchivo(session,archivo)">
                                                                                                            </li>
                                                                                                        </ng-container>
                                                                                                    </ol>
                                                                                                </div>
                                                                                            </div>
                                                                                        </div>
                                                                                        <!-- <div *ngIf="mode ==='edit' && !session['uploading'] && (session.files.length === 0)" class="fw h80px ContainerFile">
                                                                                            <div (dragover)="onDragOver($event)" (drop)="onDrop($event, session. type, session)"class="fw fh no-select" fxLayout="row" fxLayoutAlign="center center">
                                                                                                Arrastre el archivo aquí para agregarlo.
                                                                                            </div>
                                                                                        </div> -->
                                                                                    </ng-container>
                                                                                    <!-- Lista de recursos de sesiones hijos -->
                                                                                    <ng-container *ngIf="mode === 'edit'">
                                                                                        <div *ngIf="!session['uploading'] && session.sonFiles.length > 0" fxLayout="row" fxLayoutAlign="center center">
                                                                                            <div class="w-90 ContainerFileSon mgl10" style="min-height: 80px;">
                                                                                                <div fxLayout="row" fxLayoutGap="20px" class="fw pd10" (dragover)="onDragOver($event)" (drop)="onDrop($event, session. type, session)">
                                                                                                    <div fxFlex="20%" fxLayoutAlign="start start">Recursos particulares: </div>
                                                                                                    <div fxFlex="80%" fxLayoutAlign="start start">
                                                                                                        <ol style="padding-left: 10px; margin: 0;">
                                                                                                            <ng-container *ngFor="let archivo of session.sonFiles; let i = index">
                                                                                                                <li>
                                                                                                                    <span class="cursorPointer blueLink" (click)="descargarArchivo(archivo)">{{ archivo.nombre }}</span>
                                                                                                                    <img [src]="icon.close" class="h18px pdl10 makeRed cursorPointer" alt="" (click)="borrarArchivo(session, archivo)">
                                                                                                                </li>
                                                                                                            </ng-container>
                                                                                                        </ol>
                                                                                                    </div>
                                                                                                </div>
                                                                                            </div>
                                                                                        </div>
                                                                                    </ng-container>
                                                                                    <!-- Añadir recurso para sesiones base -->
                                                                                    <div *ngIf="mode !=='edit'" fxLayout="row" fxLayoutAlign="center center" class="mgt15 mgb05">
                                                                                        <input (change)="onFileSelected($event, session, false, true, null, true)" type="file" 
                                                                                        accept="application/pdf, application/vnd.ms-excel, application/vnd.openxmlformats-officedocument.spreadsheetml.sheet" 
                                                                                        #FileInputAdicional style="display: none;">
                                                                                        <button (click)="FileInputAdicional.click()" class="grayButton pd03 radius4 ft12 h28px mgr10 gray-8" fxLayout="row" fxLayoutGap="0.625" fxLayoutAlign="center center">
                                                                                            <img [src]="icon.folderUp" class="h16px pdr05" alt="">
                                                                                            Añadir recursos
                                                                                        </button>
                                                                                    </div>
                                                                                    <input (change)="onFileSelected($event, session, false, false, null, true)" type="file" accept="{{session.type == 'lectura'?'.pdf' : 'video/mp4'}}" 
                                                                                    #FileInput style="display: none;">
                                                                                    <!-- Agregar recursos pra sesiones hijos -->
                                                                                    <div *ngIf="mode ==='edit'" fxLayout="row" fxLayoutAlign="center center" class="mgt15 mgb05">
                                                                                        <input (change)="onFileSelected($event, session, false, true, null, false)" type="file" 
                                                                                        accept="application/pdf, application/vnd.ms-excel, application/vnd.openxmlformats-officedocument.spreadsheetml.sheet" 
                                                                                        #FileInputAdicional style="display: none;">
                                                                                        <button (click)="FileInputAdicional.click()" class="grayButton pd03 radius4 ft12 h28px mgr10 gray-8" fxLayout="row" fxLayoutGap="0.625" fxLayoutAlign="center center">
                                                                                            <img [src]="icon.folderUp" class="h16px pdr05" alt="">
                                                                                            Añadir recursos particulares
                                                                                        </button>
                                                                                    </div>
                                                                                    <input (change)="onFileSelected($event, session, false, false, null, false)" type="file" accept="{{session.type == 'lectura'?'.pdf' : 'video/mp4'}}" 
                                                                                    #FileInput style="display: none;">
                                                                                </ng-container>

                                                                                <ng-container *ngIf="session.type == 'actividad' || session.type == 'corazones' ">
                                                                                    <div fxLayout="row" fxLayoutAlign="center center" class="mgt15 mgb05">
                                                                                        <button (click)="structureActivity(modalActividadDetail, session);showErrorActividad = false" 
                                                                                        class="grayButton pd03 radius4 ft12 h28px mgr10 gray-8" fxLayout="row" fxLayoutGap="0.625" fxLayoutAlign="center center">
                                                                                            <img [src]="icon.taskAdd" class="h16px pdr05" alt="">
                                                                                            Estructurar actividad
                                                                                        </button>
                                                                                    </div>
                                                                                </ng-container>
                                                                                <ng-container *ngIf="session['isInvalid']">
                                                                                    <div class="mgl05 mgr10 fw" *ngFor="let mensaje of session['InvalidMessages']" fxLayoutAlign="start center">
                                                                                        <mat-icon class="red-5 ft16">info</mat-icon>
                                                                                        <span class="redText">{{mensaje}}</span>
                                                                                    </div>
                                                                                </ng-container>
                                                                            </mat-expansion-panel>
                                                                        </mat-accordion>
                                                                    </div>
                                                                </div>
                                                            </div>

                                                            <!-- Agregar sesion -->
                                                            <div *ngIf=" mode !== 'edit' " fxLayout="column" class="fw" fxLayoutAlign="center center">
                                                                <!-- Primer div para "Agregar sesión" -->
                                                                <div *ngIf="!liveCourseData['addClassMode']" fxLayout="row" class="fw mg10" fxLayoutAlign="center center">
                                                                    <!-- <span (click)="liveCourseData['addClassMode'] = !liveCourseData['addClassMode']" class="blueLink radius4 ft12 h28px no-select"> -->
                                                                    <span (click)="addSession('video')" class="blueLink radius4 ft12 h28px no-select">
                                                                        <img [src]="icon.addNew" class="h12px pdr05 makeBlue" alt="">
                                                                        Agregar sesión
                                                                    </span>
                                                                </div>

                                                                <!-- Agregar video -->
                                                                <div *ngIf="liveCourseData['addClassMode']" fxLayout="row" class="fw mgb10" fxLayoutAlign="center center">
                                                                    <div fxLayout="row" fxLayoutGap="0.625rem" fxLayoutAlign="center center">
                                                                        <span (click)="liveCourseData['addClassMode'] = false">
                                                                            <img [src]="icon.close" class="h18px pdr05 makeRed" alt="">
                                                                        </span>
                                                                        <!-- <button (click)="addSession('lectura'); liveCourseData['addClassMode'] = false" class="grayButton pd03 radius4 ft12 h28px gray-8">
                                                                            <img [src]="icon.addNew" class="h12px pdr05 makeGray8" alt="">Lectura
                                                                        </button> -->
                                                                        <button (click)="addSession('video'); liveCourseData['addClassMode'] = false" class="grayButton pd03 radius4 ft12 h28px gray-8">
                                                                            <img [src]="icon.addNew" class="h12px pdr05 makeGray8" alt="">Video
                                                                        </button>
                                                                    </div>
                                                                </div>
                                                            </div>
                                                            <ng-container *ngIf="liveCourseData['isInvalid']">
                                                                <div class="mgl08 fw"    
                                                                    [ngClass]="{'mgb10':i+1 == liveCourseData['InvalidMessages'].length}"      
                                                                    *ngFor="let mensaje of liveCourseData['InvalidMessages']; let i = index" fxLayoutAlign="start center">
                                                                    <mat-icon class="red-5 ft16">info</mat-icon>
                                                                    <span class="redText">{{mensaje}}</span>
                                                                </div>
                                                            </ng-container>
                                                        </div>
                                                    </div>                                                 
                                                    <ng-container *ngIf="isInvalidCases">
                                                        <div class="pdt05 fw" *ngFor="let mensaje of invalidMessages" fxLayoutAlign="start center">
                                                            <mat-icon class="red-5 ft16">info</mat-icon>
                                                            <span class="redText">{{mensaje}}</span>
                                                        </div>
                                                    </ng-container>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                            
                        </div>
                    </ng-container>
                </mat-tab>

                <mat-tab label="Examen">
                    <div fxLayout="row" class="containerCurso h-100" fxLayoutGap="1.5rem">
                        <div fxLayout="column" class="radius10 w-100 mgt15 mgl10 hideScroll shadowLight" style="overflow-y: auto; background-color:rgba(244, 244, 244, 0.362)">
                            <div fxLayout="row" fxLayoutAlign="start center" fxLayoutGap=".5rem" class="mgl10 mgt15 mgr10">
                                <img [src]="icon.document" class="makeBlue h20px" alt="">
                                <span class="ft500 ft14 black " style="margin-top: 5px;">Examen del curso ({{ examen?.questions?.length}} Preguntas)</span>
                            </div>
                            <div fxLayout="row" fxLayoutAlign="center" class="w-100">
                                <div style="width: 800px;">
                                    <app-questions type="test" class="mgr10" [questionMaxSize]="100" [courseData]="modulos" [nameCurso]="formNewCourse?.get('title').value?
                                    formNewCourse?.get('title').value : 'Temporal'" [nameEmpresa]="empresa?.name" (changeQuestion)="validExam = $event;formatExamQuestions()" 
                                    (emmitForm)="validExam = $event;" [questionsArray]="examen?.questions ? examen?.questions:[]" [checkQuestions]="updateTriggeQuestionsExam" 
                                    [selectedTestSkills]="[]" [mode]="mode"></app-questions>
                                </div>
                            </div>
                        </div>
    
                        <div *ngIf="false" class="column w-50 mgr25" fxLayoutGap="2rem" >
                            <div *ngIf="examen && questionsFormated" class=" mgt15  mgl10 fw" fxLayout="column">
                                <div fxLayout="column" class=" radius10  fh hideScroll shadowLight" style="overflow-y: auto; background-color:rgba(244, 244, 244, 0.362) ">
                                    <div>
                                        <div fxLayout="row" fxLayoutAlign="start center" fxLayoutGap=".5rem" class="mgl10 mgt15 mgr10">
                                            <img [src]="icon.document" class="makeBlue h20px" alt="">
                                            <span class="ft500 ft14 black " style="margin-top: 5px;">Vista Previa Examen</span>
                                        </div>
                                        <div class="pdl10 pdr10 pdt10 fw fh smallScroll modulesContainer" style="overflow-y: auto;">
                                            <ng-container>
                                                <div class="fw border radius10 shadow10 pd10 mgb20"
                                                *ngFor="let question of examen.questions; let questionIndex = index">
                                                <div class="mgb20" fxLayout.lt-md="column" fxLayout="row" fxLayout.lt-md=" start"
                                                  fxLayoutAlign="space-between center">
                                                  <span class="ft14 ft500">{{ questionIndex + 1 }}. Instrucciones:
                                                  </span>
                                                  <span ngClass="ft14 ft500" ngClass.lt-md="ft14 ft500 mgt10">
                                                    Puntaje:
                                                    <span *ngIf="isSuccess === true"></span>
                                                    {{ question.points }}</span>
                                                </div>
                                                <div class="fw" *ngIf="question.image">
                                                  <img [src]="question.image.url" alt="" style="max-height: 500px;">
                                                </div>
                                                <div *ngIf="question.typeFormated.value == questionTypes.TYPE_SINGLE_CHOICE_VALUE">
                                                  <span class="ft14 ft500"> {{ question.text }} </span>
                                                  <div class="mgt10" fxLayout="column">
                                                    <div fxLayout="row" fxLayoutAlign="space-between center" *ngFor="let option of question.options; let optionIndex = index" class="mgt05">
                                                      <span [ngClass]="{
                                                          'white-text':
                                                            isSuccess === true &&
                                                            activityAnswers[questionIndex].answerItems[optionIndex].answer
                                                        }">{{ optionIndex + 1 }}. {{ option.text }}</span>
                                                      <input type="radio" [name]="questionIndex" (change)="checkAnswer(questionIndex, optionIndex)" [disabled]="isSuccess !== null" />
                                                    </div>
                                                  </div>
                                                </div>
                                                <div *ngIf="question.typeFormated.value == questionTypes.TYPE_MULTIPLE_CHOICE_VALUE">
                                                  <span class="ft14 ft500"> {{ question.text }} </span>
                                                  <div class="mgt10" fxLayout="column">
                                                    <div fxLayout="row" fxLayoutAlign="space-between center"
                                                      *ngFor="let option of question.options; let optionIndex = index" class="mgt05">
                                                      <span [ngClass]="{ 'white-text': isSuccess === true }">{{ optionIndex + 1 }}. {{ option.text }}</span>
                                                      <input type="checkbox" (change)="checkAnswer(questionIndex, optionIndex)"
                                                        [disabled]="isSuccess !== null" />
                                                    </div>
                                                  </div>
                                                </div>
                                                <div *ngIf="question.typeFormated.value == questionTypes.TYPE_COMPLETE_VALUE">
                                                    <div [innerHTML]="question.render">
                                                    </div>
                                                </div>
                                                <div *ngIf="question.typeFormated.value == questionTypes.TYPE_TRUE_OR_FALSE_VALUE">
                                                  <span class="ft14 ft500"> {{ question.text }} </span>
                                                  <div class="mgt10" fxLayout="column">
                                                    <div fxLayout="row" fxLayoutAlign="space-between center">
                                                      <span fxFlex="60" class="ft14 ft500">Enunciado</span>
                                                      <div class="centertext w200px">
                                                        <span fxFlex="50" class="ft14 ft500">V</span>
                                                        <span fxFlex="50" class="ft14 ft500">F</span>
                                                      </div>
                                                    </div>
                                                    <div fxLayout="row" fxLayoutAlign="space-between center" class="mgt05"
                                                      *ngFor="let option of question.options; let optionIndex = index">
                                                      <div fxFlex="60" fxLayout="row" fxLayoutGap="1rem">
                                                        <span [ngClass]="{
                                                            'white-text':
                                                              isSuccess === true &&
                                                              activityAnswers[questionIndex].answerItems[optionIndex]
                                                                .answer !== null
                                                          }">{{ optionIndex + 1 }}. {{ option.text }}</span>
                                                      </div>
                                                      <div class="centertext w200px">
                                                        <input fxFlex="50" [name]="questionIndex?.toString() + optionIndex?.toString()" type="radio"
                                                          [value]="true" [disabled]="isSuccess !== null" />
                                                        <input fxFlex="50" [name]="questionIndex?.toString() + optionIndex?.toString()" type="radio"
                                                          [value]="false"[disabled]="isSuccess !== null" />
                                                      </div>
                                                    </div>
                                                  </div>
                                                </div>
                                                </div>
                                            </ng-container>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </mat-tab>

                <mat-tab *ngIf="mode === 'edit'" label="Usuarios">
                    <div fxLayout="row" fxLayoutAlign="center " class="containerCurso h-100" fxLayoutGap="1.5rem">
                        <div fxLayout="column" class="radius10 w-95 mgt15 hideScroll shadowLight" style="overflow-y: auto; background-color:rgba(244, 244, 244, 0.362)">
                            <div fxLayout="row" fxLayoutAlign="start center" fxLayoutGap=".5rem" class="mgl10 mgt15 mgr10">
                                <img [src]="icon.document" class="makeBlue h20px" alt="">
                                <span class="ft500 ft14 black " style="margin-top: 5px;">Usuario inscritos</span>
                            </div>
                            <div fxLayout="row" fxLayoutAlign="center" class="w-100">
                                <app-live-course-student-list class="w-90" [idBaseLiveCourse]="liveCourseTemplateId" [idLiveCourseSon]="liveCourseId" 
                                (userEmailsChanged)="onUserEmailsChanged($event)"></app-live-course-student-list>
                            </div>
                        </div>
                    </div>
                </mat-tab>

                <mat-tab *ngIf="mode === 'edit'" label="Seguimiento">
                    <div fxLayout="row" fxLayoutAlign="center " class="containerCurso h-100" fxLayoutGap="1.5rem">
                        <div fxLayout="column" class="radius10 w-95 mgt15 hideScroll shadowLight" style="overflow-y: auto; background-color:rgba(244, 244, 244, 0.362)">
                            <div fxLayout="row" fxLayoutAlign="start center" fxLayoutGap=".5rem" class="mgl10 mgt15 mgr10">
                                <img [src]="icon.document" class="makeBlue h20px" alt="">
                                <span class="ft500 ft14 black " style="margin-top: 5px;">Enviar correo</span>
                            </div>
                            <div fxLayout="row" fxLayoutAlign="center" class="w-100">
                                <app-live-course-following class="w-90" [studentEmails]="studentEmails" [idBaseLiveCourse]="liveCourseTemplateId" [idLiveCourseSon]="liveCourseId">
                                </app-live-course-following>
                            </div>
                        </div>
                    </div>
                </mat-tab>
            </mat-tab-group>
        </div>
    </div>
    
    <!-- endCourseModal -->
    <ng-template #endCourseModal let-modal>
        <div class="modal-header bg-web-primary text-white px-3 py-1">
            <div class="modal-title pd10" fxLayout="row" fxLayoutAlign="start center">
                <img [src]="icon.catalog" class="h18px pdr05" alt="">
                <span class="ft16 ft600 gray-10">¡Creaste un nuevo curso!</span>
            </div>
            <img style="cursor: pointer;" [src]="icon.close" (click)="modal.dismiss('Cross click')" class="h20px"  alt="">
        </div>
        <div class="modal-body">
            <div fxLayout="row" class="fw">
                <!-- Espacio para la imagen -->
                <div fxFlex="50" fxLayout="row" fxLayoutAlign="center center">
                    <img src="../../../assets/images/cursos/teamwork high five-pana.svg" alt="Descripción" class="w-80">
                </div>
        
                <!-- Espacio para el texto y los botones -->
                <div fxFlex="50" fxLayout="column" fxLayoutAlign="center center">
                    <!-- Texto encima de los botones -->
                    <div class="text-center mb-3">
                        ¿Deseas publicar el curso?
                    </div>
        
                    <!-- Botones -->
                    <div fxLayout="row" fxLayoutAlign="space-around center">
                        <button class="yellowButton radius4 ft12 h28px" fxLayout="row" fxLayoutGap="0.625" fxLayoutAlign="center center">
                            <img [src]="icon.save" class="h16px makeWhite pdr05" alt="">
                            Más tarde
                        </button>
                        <button class="blueButton radius4 ft12 h28px mgl10 gray-1" fxLayout="row" fxLayoutGap="0.625" fxLayoutAlign="center center">
                            Publicar
                            <img [src]="icon.send" class="h16px makeWhite pdl05" alt="">
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </ng-template>
    
    <!-- CLASE DETAIL MODAL ??? -->
    <ng-template #modalClaseDetail let-modal>
        <div class="modal-header bg-web-primary text-white px-3 py-1">
            <div class="modal-title pd10 ">
                <img [src]="icon[getIconSession(selectedSession.tipo)]" class="h18px pdr05" alt="">
                <span class="ft16 ft600 gray-10">Vista previa {{selectedSession.tipo}} - {{selectedSession.titulo? selectedSession.titulo: 'sin título'}}</span>
            </div>
            <img style="cursor: pointer;" [src]="icon.close" (click)="modal.dismiss('Cross click')" class="h20px"  alt="">
        </div>
        <div class="modal-body">
            <div  fxLayout="row" fxLayoutGap="60px">
                <div class="fh fw">
                    <ngx-extended-pdf-viewer *ngIf="fileViewTipe == 'pdf' && base64view " [showToolbar]="false" [base64Src]="base64view" [useBrowserLocale]="true" height="80vh"></ngx-extended-pdf-viewer>
                    <ngx-extended-pdf-viewer *ngIf="fileViewTipe == 'pdf' && srsView " [showToolbar]="false" [src]="srsView" [useBrowserLocale]="true" height="80vh"></ngx-extended-pdf-viewer>
                    <div class="video-container" *ngIf="fileViewTipe == 'video'">
                        <video *ngIf="base64view" #videoPlayer controls>
                            <source [src]="base64view" type="video/mp4">
                        </video>
                        <iframe *ngIf="!base64view"
                            id="myvideo" [src]="safeUrl" (load)="initPlayer()" frameborder="0"
                            allow="autoplay; fullscreen; picture-in-picture" allowfullscreen>
                        </iframe>
                    </div>
                </div>
            </div>
        </div>
        <!-- <div class="modal-footer">
        </div> -->
    </ng-template>
    
    <!-- ACTIVIDAD DETAIL MODAL ??? -->
    <ng-template #modalActividadDetail let-modal>
        <div class="modal-header bg-web-primary text-white px-3 py-1">
            <div class="modal-title pd10 ">
                <img [src]="icon[getIconSession(selectedSession.tipo)]" class="h18px pdr05" alt="">
                <span class="ft16 ft600 gray-10">Vista previa {{selectedSession.tipo}} - {{selectedSession.titulo? selectedSession.titulo: 'sin título'}}</span>
            </div>
            <img style="cursor: pointer;" [src]="icon.close" (click)="modal.dismiss('Cross click')" class="h20px"  alt="">
        </div>
        <div class="modal-body">
            <div fxLayout="row">
                <div class="fw pdl10 pdr10 pdt10">
                    <div class="fw">
                        <div class="stepper pdb10">
                            <div class="step" *ngFor="let item of stepsActividad; let i = index">
                                <div (click)="activeStepActividad > i ? activeStepActividad = i+1 : '' " class="no-select {{ activeStepActividad == i+1 ? 'titleActive ft400' : 'title'}}  {{  activeStepActividad > i ? 'cursorPointer' : ''}}">{{ item }}</div>
                                <div class="mgr05" *ngIf="i < stepsActividad.length - 1">
                                    <img [src]="icon.chevronRight" class=" {{activeStepActividad == i+1? 'makeGray8': 'makeGray'}}" alt="">
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <div  fxLayout="row" fxLayoutGap="60px">
                <div fxFlex="75%" class="smallScroll" style="overflow-y: auto;">
                    <div class="pdr05">
                        <!-- Informacion basica -->
                        <ng-container *ngIf="activeStepActividad == 1">
                            <div fxFlex fxLayout="column" class="container pdl10 pdt10">
                                <div fxLayout="row">
                                    <span class="titleActive ft400">Información básica</span>
                                </div>
                                <div fxLayout="row">
                                    <!-- formulario de avtividad -->
                                    <form [formGroup]="formNuevaActividadBasica" class="mgr20 fw">
                                        <div class="form-group pdt10">
                                            <label>Título</label>
                                            <div class="position-relative custom-input-container">
                                                <img [src]="icon[getIconSession(selectedSession.tipo)]" class="h20px input-icon" alt="">
                                                <input formControlName="titulo"
                                                    [class.is-invalid]="formNuevaActividadBasica.controls['titulo'].errors && showErrorActividad"
                                                    type="text" 
                                                    class="form-control customInput custom-input" placeholder="Escriba el título de la actividad aquí">
                                            </div>
                                            <div class="custom-invalid-feedback" *ngIf="formNuevaActividadBasica.controls['titulo'].errors && showErrorActividad"> 
                                                Debe indicar el título de la actividad
                                            </div>
                                        </div>
                                        <!-- <div class="form-group pdt10">
                                            <label>Descripción</label>
                                            <textarea rows="4" 
                                            [class.is-invalid]="formNuevaActividadBasica.controls['descripcion'].errors && showErrorActividad"
                                            formControlName="descripcion" type="text" class="form-control customInput" placeholder="Escriba una pequeña descripción" style="resize: none;"></textarea>
                                            <div class="invalid-feedback" *ngIf="formNuevaActividadBasica.controls['descripcion'].errors && showErrorActividad"> 
                                                Debe indicar la Descripción de la actividad
                                            </div>
                                        </div> -->
                                        <div class="form-group pdt10">
                                            <label>Recursos descargables (opcional)</label>
                                            <div class="position-relative custom-input-container">
                                                <img [src]="icon.pdf" class="h20px input-icon" alt="">
                                                <input 
                                                [class.is-invalid]="formNuevaActividadBasica.controls['recursos'].errors && showErrorActividad"
                                                (change)="onFileSelected($event,selectedSession, false, true, 'archivoActividad', true)" type="file" accept=".pdf" #fileActivityInput class="form-control customInput custom-input">
                                                <!-- <button class="custom-button ">Botón</button> -->
                                                <button (click)="fileActivityInput.click()" class="custom-button grayButton pd03 ft500 gray-8" fxLayout="row" fxLayoutGap="0.625" fxLayoutAlign="center center">
                                                    <img [src]="icon.arrowUp" class="h16px pdr05" alt="">
                                                    Adjuntar
                                                </button>
                                            </div>
                                            <div class="custom-invalid-feedback" *ngIf="formNuevaActividadBasica.controls['recursos'].errors && showErrorActividad">
                                                Debe adjuntar algun recurso adicional
                                            </div>
                                        </div>
                                        <div *ngIf="selectedSession?.archivos[0]?.uploading_file_progress >0" class="form-group pdt10">
                                            <!-- Barra de progreso File video-->
                                            <div fxLayout="column">
                                                <div fxLayout="row" fxLayoutAlign="center center" class="w-25">
                                                    <mat-progress-bar class="h10px radius6 {{selectedSession.archivos[0].uploading_file_progress >= 100? 'complete-progress-bar': ''}}" mode="determinate" [value]="selectedSession.archivos[0].uploading_file_progress"></mat-progress-bar>
                                                    <span *ngIf="selectedSession.archivos[0].uploading_file_progress < 100" class="pdl05">{{selectedSession.archivos[0].uploading_file_progress}}%</span>
                                                    <img *ngIf="selectedSession.archivos[0].uploading_file_progress>=100" [src]="icon.check" class="h16px pdl05" alt="">
                                                </div>
                                                <div fxLayout="row" *ngIf="selectedSession.archivos[0].uploading_file_progress>=100" >
                                                    <span>{{selectedSession.archivos[0].nombre}}&nbsp;</span>
                                                    <span (click)="viewFileActivity=!viewFileActivity" class="blueLink cursorPointer">{{viewFileActivity? 'Ocultar archivo':'Ver archivo'}}</span>
                                                </div>
                                            </div>
                                        </div>
                                        <div class="form-group pdt10 w-40">
                                            <label>Duración estimada (minutos)</label>
                                            <input formControlName="duracion"
                                            [class.is-invalid]="formNuevaActividadBasica.controls['duracion'].errors && showErrorActividad"
                                            type="number" min="1" class="form-control customInput">
                                            <div class="invalid-feedback" *ngIf="formNuevaActividadBasica.controls['duracion'].errors && showErrorActividad"> 
                                                Es obligatorio la duracion minima de al menos 1 minuto
                                            </div>
                                        </div>
                                    </form>
                                </div>
        
                            </div>
                        </ng-container>
                        <!-- Instrucciones generales -->
                        <ng-container *ngIf=" activeStepActividad == 99"> 
                            <div fxFlex fxLayout="column" class="container pdl10 pdt10">
                                <div fxLayout="row">
                                    <span class="titleActive ft400">Instrucciones generales de la actividad</span>
                                </div>
        
                                <div fxLayout="row" style="overflow-y: auto;">
        
                                    <form [formGroup]="formNuevaActividadGeneral" class="mgr20 fw">
                                        <div class="form-group pdt10">
                                            <label>Video explicativo</label>
                                            <div class="position-relative custom-input-container">
                                                <img [src]="icon.videoChat" class="h20px input-icon" alt="">
                                                <input 
                                                [class.is-invalid]="formNuevaActividadGeneral.controls['video'].errors && showErrorActividad"
                                                (change)="onFileSelected($event, selectedSession, false, false, 'videoActividad', true)" type="file" accept="video/mp4"  #videoActivityInput class="form-control custom-input" placeholder="Escriba el título de la actividad aquí">
                                                <button (click)="videoActivityInput.click()" class="custom-button grayButton pd03 ft500 gray-8" fxLayout="row" fxLayoutGap="0.625" fxLayoutAlign="center center">
                                                    <img [src]="icon.arrowUp" class="h16px pdr05" alt="">
                                                    Adjuntar
                                                </button>
                                            </div>
                                            <div class="custom-invalid-feedback" *ngIf="formNuevaActividadGeneral.controls['video'].errors && showErrorActividad">
                                                Debe adjuntar el video explcativo
                                            </div>
                                            <div>
                                                <span class="ft800 ft10">Nota:</span><span class="ft10">&nbsp;se recomienda que los videos tenga al menos una resolucion de 720P y pesen menso de 4 Gb</span>
                                            </div>
        
                                        </div>
                                        <div *ngIf="selectedSession['uploading'] && selectedSession['videoFileName']" class="form-group pdt10">
                                            <div fxLayout="column">
                                                <!-- Barra de progreso File video-->
                                                <div fxFlex="25" fxLayout="row" fxLayoutAlign="center center" class="w-25">
                                                    <mat-progress-bar class="h10px radius6 {{selectedSession['videoUpload'] >= 100? 'complete-progress-bar':''}}" mode="determinate" [value]="selectedSession['videoUpload']"></mat-progress-bar>
                                                    <span *ngIf="selectedSession['videoUpload']<100" class="pdl05">{{selectedSession['videoUpload']}}%</span>
                                                    <img *ngIf="selectedSession['videoUpload']>=100" [src]="icon.check" class="h16px pdl05" alt="">
                                                </div>
                                                <div fxLayout="row" *ngIf="selectedSession.vimeoId1" >
                                                    <span>{{selectedSession.videoFileName}}&nbsp;</span>
                                                    <span (click)="viewVideoActivity=!viewVideoActivity;" class="blueLink cursorPointer">{{viewVideoActivity? 'Ocultar video':'Ver video'}}</span>
                                                </div>
                                            </div>
                                            
                                        </div>
                                        
                                    </form>
                                </div>
                            </div>
                        </ng-container>
                        <!-- Preguntas -->
                        <ng-container *ngIf="activeStepActividad == 2">
                            <div fxFlex fxLayout="column" class="container pdl10 pdt10">
                                <ng-container *ngIf="false">
                                    <!-- aqui van los preguntas que se van creando -->
                                    <div *ngFor="let pregunta of selectedSession.activity.questions; let i = index" class="{{ pregunta.isInvalid ? 'ContainerModuloInvalid' : 'ContainerModulo' }}">
                                        <div fxLayout="row" fxLayoutAlign="space-between start" class="fw pd10 pdt05 pdb5">
                                            <div fxLayout="row" fxLayoutGap="10px" class="fw">
                                                <div class="ft500 ft12">
                                                    <!-- numero pregunta -->
                                                    Pregunta {{i+1}}
                                                </div>
                                                <div class="ft12">
                                                    <!-- nombre pregunta -->
                                                    <!-- <img [src]="icon.document" class="h12px pdr05 makeGray" alt="">
                                                    <span>
                                                        {{pregunta.title? pregunta.title :'Pregunta sin titulo'}}
                                                    </span> -->
                                                </div>
                                            </div>
                                            <div fxLayout="row" fxLayoutAlign="space-between start" fxLayoutGap="0.625">
                                                <img (click)="borrarPregunta(pregunta,i)" [src]="icon.trash" class="h16px pdr05 cursorPointer trash" alt="">
                                                <img *ngIf="pregunta['expanded']" (click)="pregunta['expanded'] = !pregunta['expanded'];" [src]="icon.chevronUp" class="h16px pdr05 cursorPointer" alt="">
                                                <img *ngIf="!pregunta['expanded']" (click)="pregunta['expanded'] = !pregunta['expanded']; hideOtherQuestion(pregunta);" [src]="icon.chevronDown" class="h16px pdr05 cursorPointer" alt="">
                                            </div>
                                        </div>
                                        <div *ngIf="pregunta['expanded']" class="pd10">
                                            
                                            <div fxLayout="row" class="pdt05 fw">
                                                <!-- complete -->
                                               
                                            </div>
                                            <ng-container *ngIf="pregunta.isInvalid">
                                                <div fxLayout="row" *ngFor="let mensaje of pregunta.InvalidMessages" fxLayoutAlign="start center">
                                                    <mat-icon class="red-5 ft16">info</mat-icon>
                                                    <span class="redText">{{mensaje}}</span>
                                                </div>
                                            </ng-container>
                                        </div>
                                    </div>
                                </ng-container>
                                <app-questions  [nameCurso]="formNewCourse.get('title').value?  this.formNewCourse.get('title').value : 'Temporal'" [nameEmpresa]="empresa.name" (emmitForm)="validActividad = $event"  [heartsActivity]="selectedSession.tipo == 'corazones'? true: false" [questionsArray]="selectedSession?.activity?.questions ? selectedSession.activity.questions:[] " [checkQuestions]="updateTriggeQuestions" [selectedTestSkills]="competenciasSelectedClaseFormated"></app-questions>
                                <!-- <div fxLayout="row" class="fw">
                                    <div class="mgl40 mgr10 fw">
                                        <div class="fw mgb10">
                                            <span (click)="crearPreguntaActividad()" class="yellowLink radius4 ft12 h28px no-select" fxLayout="row" fxLayoutGap="0.625" fxLayoutAlign=" center">
                                                <img [src]="icon.addNew" class="h12px pdr05 makeYellow" alt="">
                                                Agregar pregunta
                                            </span>
                                        </div>
                                    </div>
                                </div> -->
                            </div>
                        </ng-container>
                        <!-- tab vista actividad -->
                        <ng-container *ngIf="activeStepActividad == 100">
                            <div fxFlex fxLayout="column" class="container pdl10 pdt10">
                                <ng-container>
                                    <!-- aqui van los preguntas que se van creando -->
                                    <div *ngFor="let question of selectedSession.activity.questions; let questionIndex = index" class="{{question.isInvalid?'ContainerModuloInvalid':'ContainerModulo'}}">
                                        <div fxLayout="row" fxLayoutAlign="space-between start" class="fw pd05 pdb0">
                                            <div fxLayout="row" fxLayoutGap="10px" class="fw">
                                                <div class="ft500 ft12">
                                                    <!-- numero pregunta -->
                                                    Pregunta {{questionIndex+1}}
                                                </div>
                                            </div>
                                        </div>
                                        <!-- Contenedor de las preguntas -->
                                        <div class="pd05">
                                            <div fxLayout="row" fxLayoutAlign="space-between center">
                                                <div fxLayout="row" fxLayoutGap="0.625">
                                                    <div class="pdr05">
                                                        {{ question.typeFormated.displayName }}
                                                    </div>
                                                </div>
                                                <div fxLayout="row" fxLayoutAlign="end center" fxLayoutGap="10px">
                                                    <label>Puntos:</label>
                                                    <span>{{question.points}}</span>
                                                </div>
                                            </div>
                                        
                                            <div fxLayout="row" class="pdt10">
                                                <!-- imagen -->
                                                <div *ngIf="question.image && !(question.image?.url)" fxFlex="30">
                                                    <img [src]="question.image" alt="" class="w-90" style="max-height: 200px;">
                                                </div>
    
                                                <!-- imagen -->
                                                <div *ngIf="question.image?.url" fxFlex="30">
                                                    <img [src]="question.image?.url" alt="" class="w-90" style="max-height: 200px;">
                                                </div>
                                                
                                                <!-- area dependiente de la pregunta -->
                                                <div fxFlex="70" fxLayout="column" class="pdt05 fw">
                                                    <div [innerHTML]="question.render" *ngIf="question.typeFormated.value == 'complete'">
                                                    </div>
                                        
                                                    <div *ngIf="question.typeFormated.value == 'single_choice'">
                                                        <span class="ft14 ft500"> {{ question.text }} </span>
                                                        <div class="mgt10" fxLayout="column">
                                                            <div fxLayout="row" fxLayoutAlign="space-between center" *ngFor="let option of question.options; let optionIndex = index" class="mgt05">
                                                                <span class="pdr05">{{ optionIndex + 1 }}. {{ option.text }}</span>
                                                                <input type="radio" [name]="questionIndex" />
                                                            </div>
                                                        </div>
                                                    </div>
                                        
                                                    <div *ngIf="question.typeFormated.value == 'multiple_choice'">
                                                        <span class="ft14 ft500"> {{ question.text }} </span>
                                                        <div class="mgt10" fxLayout="column">
                                                            <div fxLayout="row" fxLayoutAlign="space-between center" *ngFor="let option of question.options; let optionIndex = index" class="mgt05">
                                                                <span class="pdr05">{{ optionIndex + 1 }}. {{ option.text }}</span>
                                                                <input type="checkbox" />
                                                            </div>
                                                        </div>
                                                    </div>
                                        
                                                    <div *ngIf="question.typeFormated.value == 'true-false'">
                                                        <span class="ft14 ft500"> {{ question.text }} </span>
                                                        <div class="mgt10" fxLayout="column">
                                                            <div fxLayout="row" fxLayoutAlign="space-between center">
                                                                <span fxFlex="60" class="ft14 ft500">Enunciado</span>
                                                                <div class="centertext w200px">
                                                                    <span fxFlex="50" class="ft14 ft500">V</span>
                                                                    <span fxFlex="50" class="ft14 ft500">F</span>
                                                                </div>
                                                            </div>
                                                            <div fxLayout="row" fxLayoutAlign="space-between center" class="mgt05" *ngFor="let option of question.options; let optionIndex = index">
                                                                <div fxFlex="60" fxLayout="row" fxLayoutGap="1rem">
                                                                    <span>{{ optionIndex + 1 }}. {{ option.text }}</span>
                                                                </div>
                                                                <div class="centertext w200px">
                                                                    <input fxFlex="50" [name]="questionIndex.toString() + optionIndex.toString()" type="radio" [value]="true">
                                                                    <input fxFlex="50" [name]="questionIndex.toString() + optionIndex.toString()" type="radio" [value]="false" />
                                                                </div>
                                                            </div>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                        
                                        
                                    </div>
                                </ng-container>
                            </div>
                        </ng-container>
                    </div>
                </div>
                <div fxFlex="25%" fxLayout="column" fxLayoutAlign="center center">
                    <div *ngIf="viewVideoActivity" class="video-container-small">
                        <video #videoPlayerMini controls class="fw fh">
                            <!-- <source type="video/mp4" src="data:video/mp4;base64,{{selectedSession['base64Video']}}"> -->
                            <source [src]="selectedSession['base64Video']" type="video/mp4">
                        </video>
                    </div>
                    <div *ngIf="viewFileActivity" class="fw fh pdt10">
                        <ngx-extended-pdf-viewer *ngIf="viewFileActivity" [showToolbar]="false" [base64Src]="selectedSession?.archivos[0]?.base64" [useBrowserLocale]="true" height="90%"></ngx-extended-pdf-viewer>
                    </div>
                
                    <div *ngIf="!viewFileActivity && !viewVideoActivity" fxLayout="column" fxLayoutAlign="center center" class="fw fh">
                        <img  class="pd10" src="../../../assets/images/cursos/Next steps-pana.svg" class="fw" alt="Mi SVG">
                    </div>
                </div>
            </div>
            <div fxLayout="row" fxLayoutAlign="space-between center" class="mgt10">
                <!-- Botón a la izquierda -->
                <button  (click)="activeStepActividad >1 ? activeStepActividad = activeStepActividad-1 : modal.dismiss() " class="blueButton radius4 ft12 h28px mgr10 gray-1" fxLayout="row" fxLayoutGap="0.625" fxLayoutAlign="center center">
                    <img [src]="icon.chevronLeft" class="h16px pdr05 makeWhite" alt="">
                    Regresar
                </button>        
                <!-- Contenedor para los dos botones de la derecha -->
                <div fxLayout="row" fxLayoutGap="10px">               
                    <button *ngIf="activeStepActividad<=2" class="blueButton radius4 ft12 h28px mgr10 gray-1" (click)="advanceTabActividad();" fxLayout="row" fxLayoutGap="0.625" fxLayoutAlign="center center">
                        Continuar
                        <img [src]="icon.chevronRight" class="h16px pdl05 makeWhite" alt="">
                    </button>
                    <button (click)="modal.dismiss()" *ngIf="activeStepActividad==3" class="blueButton radius4 ft12 h28px mgr10 gray-1" fxLayout="row" fxLayoutGap="0.625" fxLayoutAlign="center center">
                        Continuar
                        <img [src]="icon.chevronRight" class="h16px pdl05 makeWhite" alt="">
                    </button>        
                </div>
            </div>
        </div>
    </ng-template>
    
    <!-- CLASE COMPETENCIAS MODAL ??? -->
    <ng-template #modalAsignarCompetenciasClases let-modal>
        <div class="modal-header bg-web-primary text-white px-3 py-1">
            <div class="modal-title pd10" fxLayout="row" fxLayoutAlign="start center">
                <img [src]="icon.flash" class="h18px pdr05" alt="">
                <span class="ft16 ft600 gray-10">Asignar nuevas competencias</span>
            </div>
            <img style="cursor: pointer;" [src]="icon.close" (click)="modal.dismiss('Cross click')" class="h20px"  alt="">
        </div>
        <div class="modal-body">
            <div *ngIf="selectedSession.tipo == 'actividad'" fxLayout="row">
                <div class="fw pdl10 pdr10 pdt10">
                    <div class="fw">
                        <div class="stepper pdb10">
                            <div class="step" *ngFor="let item of stepsCompetencias; let i = index">
                                <div class= "no-select {{activeStepCompetencias == i+1? 'circleStepActive': 'circleStep'}} {{  activeStepCompetencias > i ? 'cursorPointer' : ''}}">{{ i + 1 }}</div>
                                <div (click)="activeStepCompetencias > i ? activeStepCompetencias=i+1 : '' " class="no-select {{activeStepCompetencias == i+1? 'titleActive ft400': 'title'}}  {{  activeStepCompetencias > i ? 'cursorPointer' : ''}}">{{ item }}</div>
                                <div class="mgr05" *ngIf="i < stepsCompetencias.length - 1">
                                    <img [src]="icon.chevronRight" class=" {{activeStepCompetencias == i+1? 'makeGray8': 'makeGray'}}" alt="">
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <div fxLayout="column" class="fw pdt10">
                <ng-container *ngIf="activeStepCompetencias ==1">
                    <div *ngFor="let categoria of competenciasSelectedClase" fxLayout="column" class="fw pdb10">
                        <!-- Contenedor para la categoría y el ícono -->
                        <div fxLayout="row" class="category-container">
                            <span class="ft400 pdb03 flex-fill">
                                <!-- {{categoria|json}} -->
                                {{categoria.categoria?.name ? categoria.categoria.name: categoria.name | titlecase}}
                                ({{categoria.competencias.length}})
                            </span>
                            <!-- Asumiendo que deseas agregar un ícono aquí -->
                            <img *ngIf="categoria['expanded']" (click)="categoria['expanded'] = !categoria['expanded'];" [src]="icon.chevronUp" class="h16px pdr05 cursorPointer" alt="">
                            <img *ngIf="!categoria['expanded']" (click)="categoria['expanded'] = !categoria['expanded'];" [src]="icon.chevronDown" class="h16px pdr05 cursorPointer" alt="">
                        </div>
                        <!-- Displaying Chips -->
                        <mat-chip-listbox *ngIf="categoria['expanded']" selectable multiple aria-label="Fish selection" class="fw contenedor-chips pdt05" style="max-height: 100vh !important;">
                            <mat-chip-option class="custom-chip" *ngFor="let competencia of categoria.competencias" (click)="competencia.selected = !competencia.selected;getSelectedCategoriasCompetencias()" [selected]="competencia.selected">
                                {{competencia.name | titlecase}}
                                <img *ngIf="competencia.selected" [src]="icon.close" class="makeWhite h16px pdl05" alt="">
                                <img *ngIf="!competencia.selected" [src]="icon.addNew" class="makeGray h14px pdl05" alt="">
                            </mat-chip-option>
                        </mat-chip-listbox>
                    </div>
                </ng-container>
                <ng-container *ngIf="activeStepCompetencias == 2">
                    <!-- aqui van los preguntas que se van creando -->
                    <div *ngFor="let question of  selectedSession.activity.questions; let questionIndex = index" class="{{question['isInvalid']?'ContainerModuloInvalid':'ContainerModulo'}}">
                        <div fxLayout="row" fxLayoutAlign="space-between start" class="fw pd05 pdb0">
                            <div fxLayout="row" fxLayoutGap="10px" class="fw">
                                <div class="ft500 ft12">
                                    <!-- numero pregunta -->
                                    Pregunta {{questionIndex+1}}
                                </div>
                            </div>
                        </div>
                        <div fxLayout="row" fxLayoutAlign="space-between start" class="fw pd05 pdb10">
    
                            <div fxLayout="column" class="fw">
                                <!-- Contenedor para la categoría y el ícono -->
                                <div fxLayout="row" class="category-container">
                                    <span class="ft400 pdb03 flex-fill">
                                        Competencias
                                    </span>
                                    <!-- Asumiendo que deseas agregar un ícono aquí -->
                                    <img *ngIf="question['expanded_categorias']" (click)="question['expanded_categorias'] = !question['expanded_categorias'];" [src]="icon.chevronUp" class="h16px pdr05 cursorPointer" alt="">
                                    <img *ngIf="!question['expanded_categorias']" (click)="question['expanded_categorias'] = !question['expanded_categorias'];" [src]="icon.chevronDown" class="h16px pdr05 cursorPointer" alt="">
                                </div>
                            </div>
    
                        </div>
                        <!-- contenedor de competencias -->
                        <div *ngIf="question['expanded_categorias']" fxLayout="row" fxLayoutAlign="space-between start" class="fw pd05 pdb0">
                            <div fxLayout="column" class="fw pdl10">
                                <div *ngFor="let categoria of question['competencias_tmp']" fxLayout="column" class="fw pdb10">
                                    <!-- Contenedor para la categoría y el ícono -->
                                    <div fxLayout="row" class="category-container">
                                        <span class="ft400 pdb03 flex-fill">
                                            {{categoria.categoria?.name ? categoria.categoria.name: categoria.name | titlecase}}
                                            ({{categoria.competencias.length}})
                                        </span>
                                        <!-- Asumiendo que deseas agregar un ícono aquí -->
                                        <img *ngIf="categoria['expanded']" (click)="categoria['expanded'] = !categoria['expanded'];" [src]="icon.chevronUp" class="h16px pdr05 cursorPointer" alt="">
                                        <img *ngIf="!categoria['expanded']" (click)="categoria['expanded'] = !categoria['expanded'];" [src]="icon.chevronDown" class="h16px pdr05 cursorPointer" alt="">
                                    </div>
                                    <!-- Displaying Chips -->
                                    <mat-chip-listbox *ngIf="categoria['expanded']" selectable multiple aria-label="Fish selection" class="fw contenedor-chips pdt05" style="max-height: 100vh !important;">
                                        <mat-chip-option class="custom-chip" *ngFor="let competencia of categoria.competencias" (click)="competencia.selected = !competencia.selected;" [selected]="competencia.selected">
                                            {{competencia.name | titlecase}}
                                            <img *ngIf="competencia.selected" [src]="icon.close" class="makeWhite h16px pdl05" alt="">
                                            <img *ngIf="!competencia.selected" [src]="icon.addNew" class="makeGray h14px pdl05" alt="">
                                        </mat-chip-option>
                                    </mat-chip-listbox>
                                </div>
                            </div>
                        </div>
                        <!-- Contenedor de las preguntas -->
                        <div class="pd05">
                            <div fxLayout="row" fxLayoutAlign="space-between center">
                                <div fxLayout="row" fxLayoutGap="0.625">
                                    <div class="pdr05">
                                        {{ question.type.displayName }}
                                    </div>
                                </div>
                                <div fxLayout="row" fxLayoutAlign="end center" fxLayoutGap="10px">
                                    <label>Puntos:</label>
                                    <span>{{question.points}}</span>
                                </div>
                            </div>
                            <!-- imagen -->
                            <div fxLayout="row" fxLayoutAlign="start center" class="pdt10">
                                <img [src]="question.image" alt="" style="max-height: 200px;">
                            </div>
                            <!-- area dependiete de la pregunta -->
                            <div fxLayout="row" class="pdt05 fw">
                                <div [innerHTML] ="question['render']" *ngIf="question.type.value == 'complete'"></div>
                                <div *ngIf="question.type.value == 'single_choice'">
                                    <span class="ft14 ft500"> {{ question.text }} </span>
                                    <div class="mgt10" fxLayout="column">
                                        <div fxLayout="row" fxLayoutAlign="space-between center"
                                            *ngFor="let option of question.options; let optionIndex = index" class="mgt05">
                                            <span class="pdr05">{{ optionIndex + 1 }}. {{ option.text }}</span>
                                            <input type="radio" [name]="questionIndex" />
                                        </div>
                                    </div>
                                </div>
                                <div *ngIf="question.type.value == 'multiple_choice'">
                                    <span class="ft14 ft500"> {{ question.text }} </span>
                                    <div class="mgt10" fxLayout="column">
                                        <div fxLayout="row" fxLayoutAlign="space-between center" *ngFor="let option of question.options; let optionIndex = index" class="mgt05">
                                            <span class="pdr05" >{{ optionIndex + 1 }}. {{ option.text }}</span>
                                            <input type="checkbox"/>
                                        </div>
                                    </div>
                                </div>
                                <div *ngIf="question.type.value == 'true-false'">
                                    <span class="ft14 ft500"> {{ question.text }} </span>
                                    <div class="mgt10" fxLayout="column">
                                        <div fxLayout="row" fxLayoutAlign="space-between center">
                                            <span fxFlex="60" class="ft14 ft500">Enunciado</span>
                                            <div class="centertext w200px">
                                                <span fxFlex="50" class="ft14 ft500">V</span>
                                                <span fxFlex="50" class="ft14 ft500">F</span>
                                            </div>
                                        </div>
                                        <div fxLayout="row" fxLayoutAlign="space-between center" class="mgt05" *ngFor="let option of question.options; let optionIndex = index">
                                            <div fxFlex="60" fxLayout="row" fxLayoutGap="1rem">
                                                <span>{{ optionIndex + 1 }}. {{ option.text }}</span>
                                            </div>
                                            <div class="centertext w200px">
                                                <input fxFlex="50" [name]="questionIndex.toString() + optionIndex.toString()" type="radio" [value]="true">
                                                <input fxFlex="50" [name]="questionIndex.toString() + optionIndex.toString()" type="radio" [value]="false" />
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </ng-container>
            </div>
        </div>
        <div class="modal-footer">
            <button (click)="modal.dismiss()" class="grayButton pd03 radius4 ft12 h28px mgr10 gray-8" fxLayout="row" fxLayoutGap="0.625" fxLayoutAlign="center center">
                Cancelar
            </button>  
            <button *ngIf="selectedSession.tipo!='actividad'" (click)="saveCompetenciasSession()" class="blueButton radius4 ft12 h28px mgr10 gray-1" fxLayout="row" fxLayoutGap="0.625" fxLayoutAlign="center center">
                <img [src]="icon.save" class="h16px pdr05 makeWhite" alt="">
                Guadar
            </button>
            <ng-container *ngIf="selectedSession.tipo=='actividad'">
    
                <!-- <button *ngIf="activeStepCompetencias<2" class="blueButton radius4 ft12 h28px mgr10 gray-1" fxLayout="row" fxLayoutGap="0.625" fxLayoutAlign="center center">
                    <img [src]="icon.chevronRight" class="h16px pdr05 makeWhite" alt="">
                </button>    -->
                <button *ngIf="activeStepCompetencias<2" (click)="advanceTabCompetencia()"  class="blueButton radius4 ft12 h28px mgr10 gray-1" fxLayout="row" fxLayoutGap="0.625" fxLayoutAlign="center center">
                    Continuar
                    <img [src]="icon.chevronRight" class="h16px pdl05 makeWhite" alt="">
                </button>
                <!-- <button *ngIf="activeStepCompetencias==2" (click)="saveCompetenciasActividad()" class="blueButton radius4 ft12 h28px mgr10 gray-1" fxLayout="row" fxLayoutGap="0.625" fxLayoutAlign="center center">
                    <img [src]="icon.save" class="h16px pdr05 makeWhite" alt="">
                    Guadar
                </button> -->
            </ng-container>
        </div>
    </ng-template>
    
    <!-- CREATE INSTRUCTOR MODAL -->
    <ng-template #modalCrearInstructor let-modal>
        <div class="modal-header bg-web-primary text-white px-3 py-1">
          <div class="modal-title pd10" fxLayout="row" fxLayoutAlign="start center">
            <span class="ft16 ft500 gray-10">Crear Instructor</span>
          </div>
          <img style="cursor: pointer;" [src]="icon.close" (click)="modal.dismiss('Cross click')" class="h20px" alt="">
        </div>
        <div class="modal-body" style="overflow-y: auto; max-height: 80vh;">
            <form [formGroup]="formNewInstructor" class="mgr20">
                <div class="form-group">
                    <label>Nombre del instructor</label>
                    <input formControlName="nombre" [class.is-invalid]="formNewInstructor.controls['nombre'].errors && showErrorInstructor" type="text" class="form-control customInput" placeholder="Escriba el nombre del instructor del curso aquí">
                    <div class="invalid-feedback" *ngIf="formNewInstructor.controls['nombre'].errors && showErrorInstructor"> 
                        Debe indicar el nombre del instructor.
                    </div>
                </div>
    
                <div class="form-group">
                    <label>Correo del instructor</label>
                    <input formControlName="email" [class.is-invalid]="formNewInstructor.controls['email'].errors && showErrorInstructor" type="text" class="form-control customInput" placeholder="Escriba el correo del instructor del curso aquí">
                    <div class="invalid-feedback" *ngIf="formNewInstructor.controls['email'].errors?.required && showErrorInstructor"> 
                        Debe indicar el correo del instructor.
                    </div>
                    <div class="invalid-feedback" *ngIf="formNewInstructor.controls['email'].errors?.email && showErrorInstructor"> 
                        El correo es invalido.
                    </div>
                </div>
    
    
                <div class="form-group pdt10">
                    <label>Resumen del instructor</label>
                    <textarea rows="3" [class.is-invalid]="formNewInstructor.controls['resumen'].errors && showErrorInstructor"  formControlName="resumen" type="text" class="form-control customInput" placeholder="Escriba el resumen del instructor aquí." style="resize: none;"></textarea>
                    <div class="invalid-feedback" *ngIf="formNewInstructor.controls['resumen'].errors && showErrorInstructor"> 
                        Debe indicar el resumen del instructor.
                    </div>
                </div>
                <div class="form-group pdt10">
                    <label>Foto del instructor</label>
                    <div class="avatar-selector">
                        <button (click)="instructorImage.click()" class="grayButton pd03 radius4 ft12 h28px mgr10 gray-8" fxLayout="row" fxLayoutGap="0.625" fxLayoutAlign="center center">
                            <img [src]="icon.arrowUp" class="h16px pdr05" alt="">
                            Adjuntar imagen
                        </button>
                        <input #instructorImage type="file" (change)="uploadCourseImage($event,'instructor',true)" hidden accept="image/jpeg, image/png" />
                        <div class="avatar-scroll">
                            <img *ngIf="formNewInstructor.get('foto').value" [src]="formNewInstructor.get('foto').value" alt="Imagen seleccionada" class="image shadow8">
                        </div>
                    </div>
                    <div *ngIf="formNewInstructor.controls['foto'].errors && showErrorInstructor" class="custom-invalid-feedback pdt05">
                        Debe seleccinar o subir la imagen del instructor
                    </div>
                </div>
            </form>
            <!-- Botón de guardar en la esquina inferior derecha -->
            <div fxLayout="row" fxLayoutAlign="end" class="pdt03">
                <button (click)="crearInstructor()" class="blueButton radius4 ft12 h28px mgr10 gray-1" fxLayout="row" fxLayoutGap="0.625" fxLayoutAlign="center center">
                    <img [src]="icon.save" class="h16px pdr05 makeWhite" alt="">
                    Guardar Instructor
                </button>
            </div>
        </div>
    </ng-template>
    
    <ng-template #modalCrearSkill let-modal>
        <div class="modal-header bg-web-primary text-white px-3 py-1" fxLayout="row" fxLayoutAlign="space-between center">
            <div class="modal-title pd10">
              <span class="ft16 ft500 gray-10">Asignar Competencia</span>
            </div>
            <img style="cursor: pointer;" [src]="icon.close" (click)="modal.dismiss('Cross click')" class="h20px" alt="">
        </div>
        <div class="modal-body" style="overflow-y: auto; max-height: 80vh;">
            <form [formGroup]="formNewSkill" class="fw">
                <div fxLayout="row" class="fw">
                    <div class="form-group fw">
                        <label>Nombre de la competencia</label>
                        <input formControlName="nombre" [class.is-invalid]="formNewSkill.controls['nombre'].errors && showErrorSkill" type="text" class="form-control customInput" placeholder="Escriba el nombre de la competencia">
                        <div class="invalid-feedback" *ngIf="formNewSkill.controls['nombre'].errors && showErrorSkill">
                            Debe indicar el nombre de la competencia.
                        </div>
                    </div>
                </div>
            </form>
            <!-- Botón de guardar en la esquina inferior derecha -->
            <div fxLayout="row" fxLayoutAlign="end end" class="pdt03" style="width: 100%;">
                <button *ngIf="!savingSkill" (click)="saveNewSkill()" class="blueButton gray-1 radius4 ft12 h28px mgt10" fxLayout="row" fxLayoutGap="0.625rem" fxLayoutAlign="center center">
                    <img [src]="icon.check" class="h16px pdr05 makeWhite" alt="">
                    Asignar competencia
                </button>
                <button disabled *ngIf="savingSkill" (click)="saveNewSkill()" class="grayButton gray-8 radius4 ft12 h28px mgt10" fxLayout="row" fxLayoutGap="0.625rem" fxLayoutAlign="center center">
                    <mat-spinner class="spinner-dark" diameter="20"></mat-spinner>
                    Asignar competencia
                </button>
            </div>
        </div>
    </ng-template>

    <ng-template #modalCrearPilar let-modal>
        <div class="modal-header bg-web-primary text-white px-3 py-1">
          <div class="modal-title pd10" fxLayout="row" fxLayoutAlign="start center">
            <span class="ft16 ft500 gray-10">Crear Pilar</span>
          </div>
          <img style="cursor: pointer;" [src]="icon.close" (click)="modal.dismiss('Cross click')" class="h20px" alt="">
        </div>
        <div class="modal-body" style="overflow-y: auto; max-height: 80vh;">
    
    
            <form [formGroup]="formNewPillar" class="fw">
                <div fxLayout="row" class="fw">
                    <div class="form-group fw">
                        <label>Nombre del pilar</label>
                        <input formControlName="nombre" [class.is-invalid]="formNewPillar.controls['nombre'].errors && showErrorPillar" type="text" class="form-control customInput" placeholder="Escriba el nombre del pilar">
                        <div class="invalid-feedback" *ngIf="formNewPillar.controls['nombre'].errors && showErrorPillar"> 
                            Debe indicar el nombre del pilar.
                        </div>
                    </div>
                </div>
                <!-- <div fxLayout="row" class="fw" fxLayoutAlign="start center" fxLayoutGap="10px">
                    <div class="form-group" fxFlex>
                        <label>Agregar Competencia</label>
                        <input formControlName="skillTmp"  [class.is-invalid]="formNewPillar.controls['skillTmp'].errors && showErrorPillarSkill" type="text" class="form-control customInput" placeholder="Escriba de la competencia">
                    </div>
                    <div class="invalid-feedback" *ngIf="formNewPillar.controls['skillTmp'].errors && showErrorPillarSkill"> 
                        Debe indicar el nombre de la competencia.
                    </div>
                    <button (click)="addSkill()" class="blueButton radius4 ft12 h28px mgr10 gray-1 mgt15">
                        Agregar
                    </button>
                </div> -->
                <!-- <div>
                    <div class="skills-container">
                        <ng-container *ngFor="let skill of formNewPillar.get('skills')?.value; let indexSkill = index">
                            <div
                                style="display: inline-block; margin-right: 5px; margin-bottom: 5px;"
                                class="skill-badge-complete ListHover2 radius10 backGray2 pdl05 pdr05 gray-8 mgt05">
                                {{skill}}
                                <img (click)="removeSkillTmp(skill)" style="cursor: pointer;"  [src]="icon.close"  class="h16px"  alt="">
                            </div>
                        </ng-container>
                    </div>
                </div> -->
            </form>
    
    
            
            <!-- Botón de guardar en la esquina inferior derecha -->
            <div fxLayout="row" fxLayoutAlign="end" class="pdt03">
                <button (click)="!savingPillar?saveNewPillar():''" class="{{!savingPillar?'blueButton gray-1':'grayButton pd03 gray-8 '}} radius4 ft12 h28px mgt08" fxLayout="row" fxLayoutGap="0.625" fxLayoutAlign="center center">
                    <img [src]="icon.save" class="h16px = makeWhite" alt="">
                    Guardar Pilar
                </button>
            </div>
        </div>
    </ng-template>


</ng-container>
