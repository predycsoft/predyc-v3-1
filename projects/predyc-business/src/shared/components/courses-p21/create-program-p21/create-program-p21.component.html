<ng-container *ngIf="!formNewCourse">
    <div style="display: flex; justify-content: center; align-items: center; height: 100%;">
        <mat-spinner class="spinner-dark" diameter="50"></mat-spinner>
    </div>
</ng-container>

<ng-container *ngIf="formNewCourse">
    <div class="fw" class="fw fh backWhite radius10" fxLayout="column">    <div [ngClass]="true ? 'header--edit' : ''" fxLayout="row" fxLayoutAlign="space-between " class="header pdr20 pdl10">
        <div fxLayout="row" fxLayoutAlign="space-between center" class="fw fh pdt05 pdb05"  >
            <div fxLayout="row" fxLayoutAlign="start center">
                <div *ngIf="formNewCourse?.get('titulo')?.value"  class="radius20 pdl10 pdr10 mgr10 pdt05 pdb05 backWhite ft14 fh pdl05  " fxLayout="row" fxLayoutGap="8px" fxLayoutAlign=" center">
                    <span class="input-box ft14" placeholder="Nombre del diplomado"  >{{formNewCourse?.get('titulo')?.value}}</span>
                </div>
                <ng-container *ngIf="formNewCourse">
                    <div fxLayout="row" fxLayoutAlign="start center" fxLayoutGap="20px">
                        <div fxLayout="row" fxLayoutAlign="start center">
                            <input
                            (change)="changeBorrador($event)"
                            type="checkbox" 
                            [checked]="formNewCourse?.get('proximamente')?.value">
                            <label style="padding-left: 5px; color:white">Borrador</label>
                        </div>
                        <div fxLayout="row" fxLayoutAlign="start center">
                            <input
                            (change)="changePublic($event)"
                            type="checkbox" 
                            [checked]="formNewCourse?.get('public')?.value">
                            <label style="padding-left: 5px; color:white">Es público</label>
                        </div>
                        <div fxLayout="row" fxLayoutAlign="start center">
                            <input
                            (change)="changeEnCalendario($event)"
                            type="checkbox" 
                            [checked]="formNewCourse?.get('enCalendario')?.value">
                            <label style="padding-left: 5px; color:white">En calendario</label>
                        </div>
                        <!-- <div  *ngIf="user.isSystemUser" fxLayout="row" fxLayoutAlign="start center">
                            <button
                                fxLayout="row"
                                fxLayoutGap="0.625"
                                fxLayoutAlign="center center"
                                (click)="descargarPDF()"
                                class="blueButton ft14 cursorPointer"
                                style="border-radius: 24px !important;">
                                Descargar PDF
                                <img [src]="icon.download" class="h16px pdl05 makeWhite" alt="">
                            </button>                        
                        </div> -->
                    </div>
                </ng-container>
            </div>
            <div fxLayout="row" fxLayoutGap="10px" fxLayoutAlign=" center">
                <div class="radius20 pdl10 pdr10 pdt05 pdb05 backWhite ft14 cursorPointer" routerLink="/management/courses"> 
                    Cancelar
                </div>
                <button
                    fxLayout="row"
                    fxLayoutGap="0.625"
                    fxLayoutAlign="center center"
                    class="blueButton ft14 cursorPointer"
                    (click)="saveDraftPre()"
                    style="border-radius: 24px !important;">
                    {{mode !== 'edit' ? 'Guardar diplomado' : 'Guardar diplomado'}}
                    <img [src]="icon.save" class="h16px pdl05 makeWhite" alt="">
                </button>
            </div>
        </div>
    </div>
        <div class="fh " >
            <mat-tab-group mat-stretch-tabs="false" class="swal-overlay pdt35 " (selectedTabChange)="onTabChange($event)" style="z-index: 2; position :fixed;  width: 97%;" >
                <mat-tab label="Contenido del diplomado"  style="z-index: 2; position :fixed;" >
                    <ng-container >
                        <div fxLayout="row" class=" " fxLayoutGap=""  style="overflow-y: auto; height: 80vh !important; width: 100%; ">
                            <!-- <div fxFlex="50%" class="pdl10 pdt10 fw"> -->
                            <div *ngIf="formNewCourse" class="radius10 w-30 mgt15 mgb10 mgl10 shadowLight" fxLayout="column" style="background-color: rgba(244, 244, 244, 0.362); height: fit-content;">
                                <!-- Informacion -->
                                <form [formGroup]="formNewCourse" class="mgl10 mgt15 mgr10 mgb20">
                                    <div class="fw" fxLayoutAlign="space-between center" fxLayout="row">
                                        <div fxLayout="row" fxLayoutAlign="start center" fxLayoutGap=".5rem" class="">
                                            <img [src]="icon.presentationFile" class="makeBlue h20px" alt="">
                                            <span class="ft500 ft14 black " style="margin-top: 5px;">Informacion general del diplomado</span>
                                        </div>
                                    </div>
                                    <div class="form-group mgt08 mgb08">
                                        <label class="ft12 " >Título</label>
                                        <input
                                        [class.is-invalid]="formNewCourse.controls['titulo'].errors && showErrorCurso"
                                        formControlName="titulo" type="text" class="form-control customInput2 radius6 " placeholder="Escriba el título del diplomado aquí">
                                        <div class="invalid-feedback" *ngIf="formNewCourse.controls['titulo'].errors && showErrorCurso"> 
                                            Debe indicar el título del diplo
                                        </div>
                                    </div>
                                    <mat-accordion>
                                        <mat-expansion-panel>
                                            <mat-expansion-panel-header>
                                                <mat-panel-title>
                                                    Meta datos
                                                </mat-panel-title>
                                            </mat-expansion-panel-header>
                                    
                                            <div *ngIf="user.isSystemUser" class="ft12 form-group pdt10">
                                                <label>Precio</label>
                                                <input formControlName="precio"
                                                       [class.is-invalid]="formNewCourse.controls['precio'].errors && showErrorCurso"
                                                       type="number" min="1" class="form-control customInput2">
                                                <div class="invalid-feedback" *ngIf="formNewCourse.controls['precio'].errors && showErrorCurso"> 
                                                    Debe indicar la descripción del diplomado
                                                </div>
                                            </div>
                                    
                                            <div *ngIf="user.isSystemUser" class="ft12 form-group pdt10">
                                                <label>Precio con descuento</label>
                                                <input formControlName="precioOferta"
                                                       [class.is-invalid]="formNewCourse.controls['precioOferta'].errors && showErrorCurso"
                                                       type="number" min="1" class="form-control customInput2">
                                                <div class="invalid-feedback" *ngIf="formNewCourse.controls['precioOferta'].errors && showErrorCurso"> 
                                                    Debe indicar la descripción del diplomado
                                                </div>
                                            </div>
                                    
                                            <div *ngIf="user.isSystemUser" class="ft12 form-group pdt10">
                                                <label>Enlace Stripe</label>
                                                <input formControlName="stripeUrl"
                                                       [class.is-invalid]="formNewCourse.controls['precioOferta'].errors && showErrorCurso"
                                                       type="text" class="form-control customInput2">
                                                <div class="invalid-feedback" *ngIf="formNewCourse.controls['precioOferta'].errors && showErrorCurso"> 
                                                    Debe indicar la descripción del diplomado
                                                </div>
                                            </div>
                                    
                                            <div *ngIf="user.isSystemUser" class="ft12 form-group pdt10">
                                                <label>Meta descripción del diplomado</label>
                                                <textarea [class.is-invalid]="formNewCourse.controls['metaDescripcion'].errors && showErrorCurso" rows="3"
                                                          formControlName="metaDescripcion" type="text" class="form-control ft12 customInput2"
                                                          [maxLength]="metaDescriptionMaxLength"
                                                          placeholder="Escriba la descripción del diplomado aquí" style="resize: none;"></textarea>
                                                <div class="progress-bar-container fw mgt03">
                                                    <div class="progress-bar" [style.width.%]="(formNewCourse?.controls['metaDescripcion']?.value?.length / metaDescriptionMaxLength) * 100"></div>
                                                </div>
                                                <div class="invalid-feedback" *ngIf="formNewCourse.controls['metaDescripcion'].errors && showErrorCurso"> 
                                                    Debe indicar la meta descripción del diplomado
                                                </div>
                                            </div>
                                    
                                            <div *ngIf="user.isSystemUser" class="ft12 form-group pdt10">
                                                <label>KeyWords</label>
                                                <textarea [class.is-invalid]="formNewCourse.controls['KeyWords'].errors && showErrorCurso" [maxLength]="keyWordsMaxLength"
                                                          rows="3" formControlName="KeyWords" type="text" class="form-control ft12 customInput2"
                                                          placeholder="Escriba los KeyWords del diplomado aquí" style="resize: none;"></textarea>
                                                <div class="progress-bar-container fw mgt03">
                                                    <div class="progress-bar" [style.width.%]="(formNewCourse?.controls['KeyWords']?.value?.length / keyWordsMaxLength) * 100"></div>
                                                </div>
                                                <div class="invalid-feedback" *ngIf="formNewCourse.controls['KeyWords'].errors && showErrorCurso"> 
                                                    Debe indicar los KeyWords del diplomado
                                                </div>
                                            </div>
                                    
                                        </mat-expansion-panel>
                                    </mat-accordion>
                                    
                                    <div class="form-group mgt08">
                                        <label class="ft12 " >Modalidad</label>
                                        <select
                                            [class.is-invalid]="formNewCourse.controls['modalidad'].errors && showErrorCurso"
                                            class="form-control customInput radius10" formControlName="modalidad">
                                                <option value=null>Selecciona la modalidad</option>
                                                <option value="En línea en vivo">En línea en vivo</option>
                                                <option value="Presencial">Presencial</option>
                                                <option value="Grabado">Grabado</option>
                                        </select>
                                        <div class="invalid-feedback" *ngIf="formNewCourse.controls['modalidad'].errors && showErrorCurso"> 
                                            Debe indicar la modalidad del diplomado
                                        </div>
                                    </div>
                                    <div class="form-group mgt08">
                                        <label class="ft12 " >Duración (minutos)</label>
                                        <input
                                        [class.is-invalid]="formNewCourse.controls['duracion'].errors && showErrorCurso"
                                        formControlName="duracion" type="number" class="form-control customInput2 radius6 " placeholder="Escriba el duración del diplomado en minutos aquí">
                                        <div class="invalid-feedback" *ngIf="formNewCourse.controls['duracion'].errors && showErrorCurso"> 
                                            Debe indicar la duración del diplomado
                                        </div>
                                    </div>
                                    <label>Fecha inicio</label>
                                    <div style="position: relative">
                                        <img [src]="icon.calendarAdd" class="makeGray h16px" alt="" style="position: absolute; left: 10px; top: 50%; transform: translateY(-50%);">
                                        <input formControlName="fechaInicio" [class.is-invalid]="formNewCourse.get('fechaInicio').errors && showErrorCurso" type="date" class="form-control pdl20 radius6 shadow-animation borderLight" placeholder="Ingrese los detalles de las fechas de las seciones">
                                    </div>
                                    <div fxLayout="row" fxLayoutAlign=" center" class="mgt10 fw">
                                        <form class="fw">
                                            <mat-form-field class="example-full-width fw">
                                                <mat-label>Buscar Pilar</mat-label>
                                                <input type="text" class="ft14 fw" placeholder="Seleccione uno" aria-label="Number" matInput #autoTrigger="matAutocompleteTrigger" [formControl]="pillarsForm" [matAutocomplete]="autoPillars">
                                                <mat-autocomplete [displayWith]="getOptionTextPillar" #autoPillars="matAutocomplete" class="options">
                                                <mat-option (click)="changePillar(option)" class="multiline-mat-option ft12" *ngFor="let option of filteredPillars | async" [value]="option">
                                                    <div fxLayout="row" fxLayoutAlign="space-between">
                                                        <div fxLayout="col" fxLayoutAlign="center center">
                                                            {{option.name | titlecase}}
                                                        </div>
                                                    </div>
                                                </mat-option>
                                                <mat-option  (click)="createPillar()" class="multiline-mat-option" value="null">Crear nuevo pilar</mat-option>
                                                </mat-autocomplete>
                                            </mat-form-field>
                                        </form>
                                    </div>
                                    <div class="form-group mgt08">
                                        <label class="ft12 " >Que Incluye</label>
                                        <textarea
                                        [class.is-invalid]="formNewCourse.controls['queIncluye'].errors && showErrorCurso"
                                        formControlName="queIncluye" 
                                        class="form-control customInput2 radius6" 
                                        placeholder="Escriba la duración del diplomado en minutos aquí"
                                        rows="3"></textarea>
                                        <div class="invalid-feedback" *ngIf="formNewCourse.controls['queIncluye'].errors && showErrorCurso"> 
                                            Debe indicar las fechas de las sesiones del diplomado
                                        </div>
                                    </div>
                                    <div class="form-group mgt08">
                                        <label class="ft12 " >A quien va dirigido</label>
                                        <textarea
                                        [class.is-invalid]="formNewCourse.controls['aQuienVaDirigido'].errors && showErrorCurso"
                                        formControlName="aQuienVaDirigido" 
                                        class="form-control customInput2 radius6" 
                                        placeholder="Escriba la duración del diplomado en minutos aquí"
                                        rows="3"></textarea>
                                        <div class="invalid-feedback" *ngIf="formNewCourse.controls['aQuienVaDirigido'].errors && showErrorCurso"> 
                                            Debe indicar las fechas de las sesiones del diplomado
                                        </div>
                                    </div>
                                    <div class="form-group mgt08">
                                        <label class="ft12 " >Descuentos</label>
                                        <textarea
                                        [class.is-invalid]="formNewCourse.controls['descuentos'].errors && showErrorCurso"
                                        formControlName="descuentos" 
                                        class="form-control customInput2 radius6" 
                                        placeholder="Escriba el texto de descuentos"
                                        rows="3"></textarea>
                                        <div class="invalid-feedback" *ngIf="formNewCourse.controls['descuentos'].errors && showErrorCurso"> 
                                            Debe indicar las fechas de las sesiones del diplomado
                                        </div>
                                    </div>
                                    <div *ngIf="user?.isSystemUser" class="form-group mgt08">
                                        <label class="ft12">URL personalizado</label>
                                        <div class="input-group">
                                            <input
                                            [class.is-invalid]="formNewCourse.controls['customUrl'].errors && showErrorCurso"
                                            formControlName="customUrl"
                                            type="text"
                                            class="form-control customInput2 radius6"
                                            placeholder="Escriba el URL del diplomado aquí"
                                            >
                                            <div class="input-group-append">
                                                <span class="input-group-text">{{ formNewCourse?.controls['customUrl']?.value?.length || 0 }}</span>
                                            </div>
                                        </div>
                                        <div class="invalid-feedback" *ngIf="formNewCourse?.controls['customUrl']?.errors && showErrorCurso">
                                            Debe indicar el URL del diplomado
                                        </div>
                                    </div>
                                    <div class="ft12 form-group pdt10">
                                        <label>Descripción del Diplomado</label>
                                        <textarea [class.is-invalid]="formNewCourse.controls['descripcion'].errors && showErrorCurso"
                                        rows="3"  formControlName="descripcion" type="text" class="form-control ft12  customInput2" 
                                        placeholder="Escriba la descripción del Diplomado aquí" style="resize: none;"></textarea>
                                        <div class="invalid-feedback" *ngIf="formNewCourse.controls['descripcion'].errors && showErrorCurso"> 
                                            Debe indicar la descripción del Diplomado
                                        </div>
                                    </div>
                                    <div class="form-group pdt10">
                                        <label class="ft12 pdb05 "  >Foto del Diplomado</label>
                                        <div fxLayout="row" fxLayoutAlign="start end" >
                                                <!-- <button class="add-button">Adjuntar nueva</button> -->
                                                <input #cursoImage type="file" (change)="uploadCourseImage($event,'curso')" hidden accept="image/jpeg, image/png,image/webp" />
                                                <!-- <div class="image-scroll">
                                                    <img *ngFor="let imagen of imagenesCurso" (click)="seleccionarImagenCurso(imagen)" [src]="imagen" alt="Imagen seleccionada" class="image cursorPointer {{this.formNewCourse.get('imagen').value == imagen? 'img-active': ''}}">
                                                </div> -->
                                                <div class="image-scroll">
                                                    <img *ngIf="formNewCourse.get('imagen').value" [src]="formNewCourse.get('imagen').value" alt="Imagen seleccionada" class="avatarSquare8 radius6">
                                                </div>
                                                <div class="fw" >
                                                    <button (click)="cursoImage.click()" class="grayButton pd03 radius6 ft12 ft500 h28px mgr10 gray-8" fxLayoutGap="0.625" >
                                                        <img [src]="icon.arrowUp" class="h16px pdr05" alt="">
                                                        Adjuntar imagen
                                                    </button>
                                                </div>
                                        </div>
                                    </div>
                                    <div *ngIf="formNewCourse.controls['imagen'].errors && showErrorCurso" class="custom-invalid-feedback pdt05">
                                        Debe seleccionar o subir la imagen del diplomado
                                    </div>     
                                </form>
                            </div>
                            <div class="column w-70 mgr25 fh" fxLayoutGap="2rem" style="margin-bottom: 15px;" >
                                    <div  class=" mgt15  mgl10 fw" fxLayout="column">
                                        <div fxLayout="column" class=" radius10  shadowLight" style=" background-color:rgba(244, 244, 244, 0.362); margin-bottom: 50px !important; overflow-y: auto; max-height: 150vh;">
                                            <div>
                                                <div fxLayout="row" fxLayoutAlign="start center" fxLayoutGap=".5rem" class="mgl10 mgt15 mgr10">
                                                    <img [src]="icon.document" class="makeBlue h20px" alt="">
                                                    <span class="ft500 ft14 black " style="margin-top: 5px;">Contenido del diplomado - {{formNewCourse?.get('duracion')?.value | formatDuration}}</span>
                                                </div>
                                                <div class="pdl10 pdr10 pdt10 fw ">
                                                    <div fxLayout="column" class="fw fh mgb20"> 
                                                        <!-- aqui alejandra -->
                                                        <!-- aqui van los modulos que se van creando -->
                                                        <div *ngFor="let modulo of modulos; let iModulo = index" class="{{modulo['isInvalid']? 'ContainerModuloInvalid' : 'ContainerModulo'}}">
                                                            <div fxLayout="row" fxLayoutAlign="space-between start" class="fw  pd08  ">
                                                                <div fxLayout="row" fxLayoutGap="10px" class="fw">
                                                                    <div class="ft500 ft12 p ">
                                                                        <!-- numero del modulo -->
                                                                        Diplomado {{modulo.numero}}:
                                                                    </div>
                                                                    <div class="ft12">
                                                                        <!-- nombre del modulo -->
                                                                        <!-- <img [src]="icon.document" class="h12px pdr05 makeGray" alt=""> -->
                                                                        <div *ngIf="modulo.titulo && !modulo['editarTitulo']; then tituloPresente; else ModuloSinTitulo"></div>
                                                                        <ng-template #tituloPresente>
                                                                            <span (click)="modulo['editarTitulo'] = true;modulo['tituloTMP'] = modulo?.titulo">
                                                                                {{modulo.titulo}}
                                                                            </span>
                                                                            <!-- <img (click)="modulo['editarTitulo'] = true;modulo['tituloTMP'] = modulo?.titulo" [src]="icon.licencias" class="h18px pdl05 makeGray edit cursorPointer" alt=""> -->
                                                                        </ng-template>
                                                                        <ng-template #ModuloSinTitulo>
                                                                            <input #inputRefModulo *ngIf="!modulo.titulo" 
                                                                                   type="text" 
                                                                                   [(ngModel)]="modulo['tituloTMP']" 
                                                                                   (keyup.enter)="confirmarTitulo(modulo)" 
                                                                                   placeholder="Escriba título aquí" 
                                                                                   class="inputInvisible">
                                                                            <input #inputRefModulo *ngIf="modulo.titulo" 
                                                                                   type="text" 
                                                                                   [(ngModel)]="modulo['tituloTMP']" 
                                                                                   (keyup.enter)="confirmarTitulo(modulo)" 
                                                                                   [value]="modulo.titulo" 
                                                                                   placeholder="Escriba título aquí" 
                                                                                   class="inputInvisible">
                                                                            <img (click)="confirmarTitulo(modulo)" 
                                                                                 matTooltip="Confirmar título" 
                                                                                 [src]="icon.check" 
                                                                                 class="h18px pdl05 makeGray edit cursorPointer" 
                                                                                 alt="">
                                                                        </ng-template>
                                                                    </div>
                                                                </div>
                                                                <div fxLayout="row" fxLayoutAlign="space-between start" fxLayoutGap="0.625">
                                                                    <img (click)="deleteModule(modulo)" [src]="icon.trash" class="h16px pdr05 cursorPointer trash" alt="">
                                                                    <img *ngIf="modulo['expanded']" (click)="expandModulo(modulo); hideModuleClasses(modulo)" [src]="icon.chevronUp" class="h16px pdr05 cursorPointer" alt="">
                                                                    <img *ngIf="!modulo['expanded']" (click)="expandModulo(modulo); hideOtherModules(modulo)" [src]="icon.chevronDown" class="h16px pdr05 cursorPointer" alt="">                                                       
                                                                </div>
                                                            </div>
                                                            <!-- Contenedor de las clases -->
                                                            <div *ngIf="modulo['expanded']">
                                                                <!-- Contenedor Principal -->
                                                                <div fxLayout="row" class="fw" fxLayoutAlign="space-around center" >
                                                                    <!-- contenedor de detalles diplomado -->
                                                                    <div fxLayout="row" fxLayoutAlign="center center">
                                                                        <form class="example-form">
                                                                            <mat-form-field class="example-full-width fw">
                                                                            <mat-label>Buscar Instructor</mat-label>
                                                                            <input type="text"
                                                                                class="ft14 fw"   
                                                                                placeholder="Seleccione uno"
                                                                                aria-label="Number"
                                                                                matInput
                                                                                #autoTrigger="matAutocompleteTrigger"
                                                                                [formControl]="modulo['instructoresForm']"
                                                                                [matAutocomplete]="autoInstructores">
                                                                            <mat-autocomplete [displayWith]="getOptionText" #autoInstructores="matAutocomplete" class="options">
                                                                                <mat-option (click)="setInstructor(option,modulo)" class="multiline-mat-option" *ngFor="let option of modulo['filteredinstructores'] | async" [value]="option">
                                                                                <div fxLayout="row" fxLayoutAlign="space-between">
                                                                                    <div fxLayout="col" fxLayoutAlign="center center" class="ft12">
                                                                                    {{option.nombre | titlecase}}
                                                                                    </div>
                                                                                </div>
                                                                                </mat-option>
                                                                                <!-- <mat-option  (click)="createInstructor()" class="multiline-mat-option" value="null">Crear nuevo instructor</mat-option> -->
                                                                            </mat-autocomplete>
                                                                            </mat-form-field>
                                                                        </form>
                                                                    </div>
                                                                    <div fxLayout="row" fxLayoutAlign="center center">
                                                                        <div>
                                                                            <span>Fecha:</span>
                                                                        </div>
                                                                        <div style="position: relative">
                                                                            <img [src]="icon.calendarAdd" class="makeGray h16px" alt="" style="position: absolute; left: 10px; top: 50%; transform: translateY(-50%);">
                                                                            <input [(ngModel)]="modulo['fechaInicio']" type="date" class="form-control pdl20 radius6 shadow-animation borderLight" placeholder="Ingrese los detalles de las fechas">
                                                                        </div>
                                                                    </div>
                                                                    <div fxLayout="row" fxLayoutAlign="center center">
                                                                        <div>
                                                                            <span>Duración (en minutos):</span>
                                                                        </div>
                                                                        <div>
                                                                            <input [(ngModel)]="modulo['duracion']" type="number" class="form-control radius6 shadow-animation borderLight" placeholder="duración">
                                                                        </div>
                                                                    </div>
                                                                    
                                                                </div>
                                                                <ng-container *ngIf="modulo['isInvalid']">
                                                                    <div class="mgl08 fw"    
                                                                      [ngClass]="{'mgb10':i+1 == modulo['InvalidMessages'].length}"      
                                                                      *ngFor="let mensaje of modulo['InvalidMessages']; let i = index" fxLayoutAlign="start center">
                                                                        <mat-icon class="red-5 ft16">info</mat-icon>
                                                                        <span class="redText">{{mensaje}}</span>
                                                                    </div>
                                                                </ng-container>
                                                            </div>
                                                        </div>
                                                        <div fxLayout="row" fxLayoutAlign="center center">
                                                            <span (click)="addModulo()" class="blueLink radius4 ft12 h28px no-select" fxLayout="row" fxLayoutGap="0.625" fxLayoutAlign="center center">
                                                                <img [src]="icon.addNew" class="h12px pdr05 makeBlue" alt="">
                                                                Agregar Diplomado
                                                            </span>
                                                        </div>                                                    
                                                        <ng-container *ngIf="isInvalidCases">
                                                            <div class="pdt05 fw" *ngFor="let mensaje of invalidMessages" fxLayoutAlign="start center">
                                                                <mat-icon class="red-5 ft16">info</mat-icon>
                                                                <span class="redText">{{mensaje}}</span>
                                                            </div>
                                                        </ng-container>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                    </div>
                            </div>
                        </div>
                    </ng-container>
                </mat-tab>
            </mat-tab-group>
        </div>
    </div>
    
    <!-- endCourseModal -->
    <ng-template #endCourseModal let-modal>
        <div class="modal-header bg-web-primary text-white px-3 py-1">
            <div class="modal-title pd10" fxLayout="row" fxLayoutAlign="start center">
                <img [src]="icon.catalog" class="h18px pdr05" alt="">
                <span class="ft16 ft600 gray-10">¡Creaste un nuevo diplomado!</span>
            </div>
            <img style="cursor: pointer;" [src]="icon.close" (click)="modal.dismiss('Cross click')" class="h20px"  alt="">
        </div>
        <div class="modal-body">
            <div fxLayout="row" class="fw">
                <!-- Espacio para la imagen -->
                <div fxFlex="50" fxLayout="row" fxLayoutAlign="center center">
                    <img src="../../../assets/images/cursos/teamwork high five-pana.svg" alt="Descripción" class="w-80">
                </div>
        
                <!-- Espacio para el texto y los botones -->
                <div fxFlex="50" fxLayout="column" fxLayoutAlign="center center">
                    <!-- Texto encima de los botones -->
                    <div class="text-center mb-3">
                        ¿Deseas publicar el diplomado?
                    </div>
        
                    <!-- Botones -->
                    <div fxLayout="row" fxLayoutAlign="space-around center">
                        <button class="yellowButton radius4 ft12 h28px" fxLayout="row" fxLayoutGap="0.625" fxLayoutAlign="center center">
                            <img [src]="icon.save" class="h16px makeWhite pdr05" alt="">
                            Más tarde
                        </button>
                        <button class="blueButton radius4 ft12 h28px mgl10 gray-1" fxLayout="row" fxLayoutGap="0.625" fxLayoutAlign="center center">
                            Publicar
                            <img [src]="icon.send" class="h16px makeWhite pdl05" alt="">
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </ng-template>
    
    <!-- CLASE DETAIL MODAL -->
    <ng-template #modalClaseDetail let-modal>
        <div class="modal-header bg-web-primary text-white px-3 py-1">
            <div class="modal-title pd10 ">
                <img [src]="icon[getIconClase(selectedClase.tipo)]" class="h18px pdr05" alt="">
                <span class="ft16 ft600 gray-10">Vista previa {{selectedClase.tipo}} - {{selectedClase.titulo? selectedClase.titulo: 'sin título'}}</span>
            </div>
            <img style="cursor: pointer;" [src]="icon.close" (click)="modal.dismiss('Cross click')" class="h20px"  alt="">
        </div>
        <div class="modal-body">
            <div  fxLayout="row" fxLayoutGap="60px">
                <div class="fh fw">
                    <ngx-extended-pdf-viewer *ngIf="fileViewTipe == 'pdf' && base64view " [showToolbar]="false" [base64Src]="base64view" [useBrowserLocale]="true" height="80vh"></ngx-extended-pdf-viewer>
                    <ngx-extended-pdf-viewer *ngIf="fileViewTipe == 'pdf' && srsView " [showToolbar]="false" [src]="srsView" [useBrowserLocale]="true" height="80vh"></ngx-extended-pdf-viewer>
                    <div class="video-container" *ngIf="fileViewTipe == 'video'">
                        <video *ngIf="base64view" #videoPlayer controls>
                            <source [src]="base64view" type="video/mp4">
                        </video>
                        <iframe *ngIf="!base64view"
                            id="myvideo" [src]="safeUrl" (load)="initPlayer()" frameborder="0"
                            allow="autoplay; fullscreen; picture-in-picture" allowfullscreen>
                        </iframe>
                    </div>
                </div>
            </div>
        </div>
        <!-- <div class="modal-footer">
        </div> -->
    </ng-template>
    
    <!-- ACTIVIDAD DETAIL MODAL -->
    <ng-template #modalActividadDetail let-modal>
        <div class="modal-header bg-web-primary text-white px-3 py-1">
            <div class="modal-title pd10 ">
                <img [src]="icon[getIconClase(selectedClase.tipo)]" class="h18px pdr05" alt="">
                <span class="ft16 ft600 gray-10">Vista previa {{selectedClase.tipo}} - {{selectedClase.titulo? selectedClase.titulo: 'sin título'}}</span>
            </div>
            <img style="cursor: pointer;" [src]="icon.close" (click)="modal.dismiss('Cross click')" class="h20px"  alt="">
        </div>
        <div class="modal-body">
            <div fxLayout="row">
                <div class="fw pdl10 pdr10 pdt10">
                    <div class="fw">
                        <div class="stepper pdb10">
                            <div class="step" *ngFor="let item of stepsActividad; let i = index">
                                <div (click)="activeStepActividad > i ? activeStepActividad = i+1 : '' " class="no-select {{ activeStepActividad == i+1 ? 'titleActive ft400' : 'title'}}  {{  activeStepActividad > i ? 'cursorPointer' : ''}}">{{ item }}</div>
                                <div class="mgr05" *ngIf="i < stepsActividad.length - 1">
                                    <img [src]="icon.chevronRight" class=" {{activeStepActividad == i+1? 'makeGray8': 'makeGray'}}" alt="">
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <div  fxLayout="row" fxLayoutGap="60px">
                <div fxFlex="75%" class="smallScroll" style="overflow-y: auto;">
                    <div class="pdr05">
                        <!-- Informacion basica -->
                        <ng-container *ngIf="activeStepActividad == 1">
                            <div fxFlex fxLayout="column" class="container pdl10 pdt10">
                                <div fxLayout="row">
                                    <span class="titleActive ft400">Información básica</span>
                                </div>
                                <div fxLayout="row">
                                    <!-- formulario de avtividad -->
                                    <form [formGroup]="formNuevaActividadBasica" class="mgr20 fw">
                                        <div class="form-group pdt10">
                                            <label>Título</label>
                                            <div class="position-relative custom-input-container">
                                                <img [src]="icon[getIconClase(selectedClase.tipo)]" class="h20px input-icon" alt="">
                                                <input formControlName="titulo"
                                                    [class.is-invalid]="formNuevaActividadBasica.controls['titulo'].errors && showErrorActividad"
                                                    type="text" 
                                                    class="form-control customInput custom-input" placeholder="Escriba el título de la actividad aquí">
                                            </div>
                                            <div class="custom-invalid-feedback" *ngIf="formNuevaActividadBasica.controls['titulo'].errors && showErrorActividad"> 
                                                Debe indicar el título de la actividad
                                            </div>
                                        </div>
                                        <!-- <div class="form-group pdt10">
                                            <label>Descripción</label>
                                            <textarea rows="4" 
                                            [class.is-invalid]="formNuevaActividadBasica.controls['descripcion'].errors && showErrorActividad"
                                            formControlName="descripcion" type="text" class="form-control customInput" placeholder="Escriba una pequeña descripción" style="resize: none;"></textarea>
                                            <div class="invalid-feedback" *ngIf="formNuevaActividadBasica.controls['descripcion'].errors && showErrorActividad"> 
                                                Debe indicar la Descripción de la actividad
                                            </div>
                                        </div> -->
                                        <div class="form-group pdt10">
                                            <label>Recursos descargables (opcional)</label>
                                            <div class="position-relative custom-input-container">
                                                <img [src]="icon.pdf" class="h20px input-icon" alt="">
                                                <input 
                                                [class.is-invalid]="formNuevaActividadBasica.controls['recursos'].errors && showErrorActividad"
                                                (change)="onFileSelected($event,selectedClase,false,selectedModulo,true,'archivoActividad')" type="file" accept=".pdf" #fileActivityInput class="form-control customInput custom-input">
                                                <!-- <button class="custom-button ">Botón</button> -->
                                                <button (click)="fileActivityInput.click()" class="custom-button grayButton pd03 ft500 gray-8" fxLayout="row" fxLayoutGap="0.625" fxLayoutAlign="center center">
                                                    <img [src]="icon.arrowUp" class="h16px pdr05" alt="">
                                                    Adjuntar
                                                </button>
                                            </div>
                                            <div class="custom-invalid-feedback" *ngIf="formNuevaActividadBasica.controls['recursos'].errors && showErrorActividad">
                                                Debe adjuntar algun recurso adicional
                                            </div>
                                        </div>
                                        <div *ngIf="selectedClase?.archivos[0]?.uploading_file_progress >0" class="form-group pdt10">
                                            <!-- Barra de progreso File video-->
                                            <div fxLayout="column">
                                                <div fxLayout="row" fxLayoutAlign="center center" class="w-25">
                                                    <mat-progress-bar class="h10px radius6 {{selectedClase.archivos[0].uploading_file_progress >= 100? 'complete-progress-bar': ''}}" mode="determinate" [value]="selectedClase.archivos[0].uploading_file_progress"></mat-progress-bar>
                                                    <span *ngIf="selectedClase.archivos[0].uploading_file_progress < 100" class="pdl05">{{selectedClase.archivos[0].uploading_file_progress}}%</span>
                                                    <img *ngIf="selectedClase.archivos[0].uploading_file_progress>=100" [src]="icon.check" class="h16px pdl05" alt="">
                                                </div>
                                                <div fxLayout="row" *ngIf="selectedClase.archivos[0].uploading_file_progress>=100" >
                                                    <span>{{selectedClase.archivos[0].nombre}}&nbsp;</span>
                                                    <span (click)="viewFileActivity=!viewFileActivity" class="blueLink cursorPointer">{{viewFileActivity? 'Ocultar archivo':'Ver archivo'}}</span>
                                                </div>
                                            </div>
                                        </div>
                                        <div class="form-group pdt10 w-40">
                                            <label>Duración estimada (minutos)</label>
                                            <input formControlName="duracion"
                                            [class.is-invalid]="formNuevaActividadBasica.controls['duracion'].errors && showErrorActividad"
                                            type="number" min="1" class="form-control customInput">
                                            <div class="invalid-feedback" *ngIf="formNuevaActividadBasica.controls['duracion'].errors && showErrorActividad"> 
                                                Es obligatorio la duracion minima de al menos 1 minuto
                                            </div>
                                        </div>
                                    </form>
                                </div>
        
                            </div>
                        </ng-container>
                        <!-- Instrucciones generales -->
                        <ng-container *ngIf=" activeStepActividad == 99"> 
                            <div fxFlex fxLayout="column" class="container pdl10 pdt10">
                                <div fxLayout="row">
                                    <span class="titleActive ft400">Instrucciones generales de la actividad</span>
                                </div>
        
                                <div fxLayout="row" style="overflow-y: auto;">
        
                                    <form [formGroup]="formNuevaActividadGeneral" class="mgr20 fw">
                                        <div class="form-group pdt10">
                                            <label>Video explicativo</label>
                                            <div class="position-relative custom-input-container">
                                                <img [src]="icon.videoChat" class="h20px input-icon" alt="">
                                                <input 
                                                [class.is-invalid]="formNuevaActividadGeneral.controls['video'].errors && showErrorActividad"
                                                (change)="onFileSelected($event,selectedClase,false,selectedModulo,false,'videoActividad')" type="file" accept="video/mp4"  #videoActivityInput class="form-control custom-input" placeholder="Escriba el título de la actividad aquí">
                                                <button (click)="videoActivityInput.click()" class="custom-button grayButton pd03 ft500 gray-8" fxLayout="row" fxLayoutGap="0.625" fxLayoutAlign="center center">
                                                    <img [src]="icon.arrowUp" class="h16px pdr05" alt="">
                                                    Adjuntar
                                                </button>
                                            </div>
                                            <div class="custom-invalid-feedback" *ngIf="formNuevaActividadGeneral.controls['video'].errors && showErrorActividad">
                                                Debe adjuntar el video explcativo
                                            </div>
                                            <div>
                                                <span class="ft800 ft10">Nota:</span><span class="ft10">&nbsp;se recomienda que los videos tenga al menos una resolucion de 720P y pesen menso de 4 Gb</span>
                                            </div>
        
                                        </div>
                                        <div *ngIf="selectedClase['uploading'] && selectedClase['videoFileName']" class="form-group pdt10">
                                            <div fxLayout="column">
                                                <!-- Barra de progreso File video-->
                                                <div fxFlex="25" fxLayout="row" fxLayoutAlign="center center" class="w-25">
                                                    <mat-progress-bar class="h10px radius6 {{selectedClase['videoUpload'] >= 100? 'complete-progress-bar':''}}" mode="determinate" [value]="selectedClase['videoUpload']"></mat-progress-bar>
                                                    <span *ngIf="selectedClase['videoUpload']<100" class="pdl05">{{selectedClase['videoUpload']}}%</span>
                                                    <img *ngIf="selectedClase['videoUpload']>=100" [src]="icon.check" class="h16px pdl05" alt="">
                                                </div>
                                                <div fxLayout="row" *ngIf="selectedClase.vimeoId1" >
                                                    <span>{{selectedClase.videoFileName}}&nbsp;</span>
                                                    <span (click)="viewVideoActivity=!viewVideoActivity;" class="blueLink cursorPointer">{{viewVideoActivity? 'Ocultar video':'Ver video'}}</span>
                                                </div>
                                            </div>
                                            <!-- <div *ngIf="viewVideoActivity">
                                                <div class="video-container-small">
                                                    <video #videoPlayerMini controls>
                                                        <source type="video/mp4" src="data:video/mp4;base64,{{selectedClase['base64Video']}}">
                                                    </video>
                                                </div>
                                            </div> -->
                                        </div>
                                        <!-- <div class="form-group pdt10">
                                            <label>Instrucciones</label>
                                            <textarea formControlName="instrucciones"
                                            [class.is-invalid]="formNuevaActividadGeneral.controls['instrucciones'].errors && showErrorActividad" 
                                            rows="3"  type="text" class="form-control customInput" placeholder="Escriba el resumen del diplomado aquí" style="resize: none;"></textarea>
                                            <div class="invalid-feedback" *ngIf="formNuevaActividadGeneral.controls['instrucciones'].errors && showErrorActividad">
                                                Debe indicar las instrucciones de la actividad.
                                            </div>
                                        </div> -->
        
                                        <!-- <div class="form-group pdt10">
                                            <label>Recursos descargables</label>
                                            <div class="position-relative custom-input-container">
                                                <img [src]="icon.pdf" class="h20px input-icon" alt="">
                                                <input 
                                                [class.is-invalid]="formNuevaActividadGeneral.controls['recursos'].errors && showErrorActividad"
                                                (change)="onFileSelected($event,selectedClase,false,selectedModulo,true,'archivoActividad')" type="file" accept=".pdf" #fileActivityInput class="form-control customInput custom-input">
                                                <button (click)="fileActivityInput.click()" class="custom-button grayButton pd03 ft500 gray-8" fxLayout="row" fxLayoutGap="0.625" fxLayoutAlign="center center">
                                                    <img [src]="icon.arrowUp" class="h16px pdr05" alt="">
                                                    Adjuntar
                                                </button>
                                            </div>
                                            <div class="custom-invalid-feedback" *ngIf="formNuevaActividadGeneral.controls['recursos'].errors && showErrorActividad">
                                                Debe adjuntar algun recurso adicional
                                            </div>
                                        </div>
                                        <div *ngIf="selectedClase?.archivos[0]?.uploading_file_progress >0" class="form-group pdt10">
                                            <div fxLayout="column">
                                                <div fxLayout="row" fxLayoutAlign="center center" class="w-25">
                                                    <mat-progress-bar class="h10px radius6 {{selectedClase.archivos[0].uploading_file_progress >= 100? 'complete-progress-bar': ''}}" mode="determinate" [value]="selectedClase.archivos[0].uploading_file_progress"></mat-progress-bar>
                                                    <span *ngIf="selectedClase.archivos[0].uploading_file_progress < 100" class="pdl05">{{selectedClase.archivos[0].uploading_file_progress}}%</span>
                                                    <img *ngIf="selectedClase.archivos[0].uploading_file_progress>=100" [src]="icon.check" class="h16px pdl05" alt="">
                                                </div>
                                                <div fxLayout="row" *ngIf="selectedClase.archivos[0].uploading_file_progress>=100" >
                                                    <span>{{selectedClase.archivos[0].nombre}}&nbsp;</span>
                                                    <span (click)="viewFileActivity=!viewFileActivity" class="blueLink cursorPointer">{{viewFileActivity? 'Ocultar archivo':'Ver archivo'}}</span>
                                                </div>
                                            </div>
                                        </div> -->
                                        <!-- <ngx-extended-pdf-viewer *ngIf="viewFileActivity" [showToolbar]="false" [base64Src]="selectedClase?.archivos[0]?.base64" [useBrowserLocale]="true" height="25vh"></ngx-extended-pdf-viewer> -->
                                    </form>
                                </div>
                            </div>
                        </ng-container>
                        <!-- Preguntas -->
                        <ng-container *ngIf="activeStepActividad == 2">
                            <div fxFlex fxLayout="column" class="container pdl10 pdt10">
                                <ng-container *ngIf="false">
                                    <!-- aqui van los preguntas que se van creando -->
                                    <div *ngFor="let pregunta of selectedClase.activity.questions; let i = index" class="{{ pregunta.isInvalid ? 'ContainerModuloInvalid' : 'ContainerModulo' }}">
                                        <div fxLayout="row" fxLayoutAlign="space-between start" class="fw pd10 pdt05 pdb5">
                                            <div fxLayout="row" fxLayoutGap="10px" class="fw">
                                                <div class="ft500 ft12">
                                                    <!-- numero pregunta -->
                                                    Pregunta {{i+1}}
                                                </div>
                                                <div class="ft12">
                                                    <!-- nombre pregunta -->
                                                    <!-- <img [src]="icon.document" class="h12px pdr05 makeGray" alt="">
                                                    <span>
                                                        {{pregunta.title? pregunta.title :'Pregunta sin titulo'}}
                                                    </span> -->
                                                </div>
                                            </div>
                                            <div fxLayout="row" fxLayoutAlign="space-between start" fxLayoutGap="0.625">
                                                <img (click)="borrarPregunta(pregunta,i)" [src]="icon.trash" class="h16px pdr05 cursorPointer trash" alt="">
                                                <img *ngIf="pregunta['expanded']" (click)="pregunta['expanded'] = !pregunta['expanded'];" [src]="icon.chevronUp" class="h16px pdr05 cursorPointer" alt="">
                                                <img *ngIf="!pregunta['expanded']" (click)="pregunta['expanded'] = !pregunta['expanded']; hideOtherQuestion(pregunta);" [src]="icon.chevronDown" class="h16px pdr05 cursorPointer" alt="">
                                            </div>
                                        </div>
                                        <div *ngIf="pregunta['expanded']" class="pd10">
                                            <!-- <div fxLayout="row" fxLayoutAlign="space-between center">
                                                <div fxLayout="row" fxLayoutGap="0.625">
                                                    <div *ngFor="let questionType of questionTypes" class="pdr05">
                                                        <button (click)="onQuestionTypeChange(pregunta, questionType.value)" class="{{pregunta.type.value == questionType.value ? 'backGray4': 'grayButton pd03' }} radius4 ft12 h28px gray-8">{{ questionType.displayName }}</button>
                                                    </div>
                                                </div>
                                                
                                                <div fxLayout="row" fxLayoutAlign="end center" fxLayoutGap="10px">
                                                    <label>Puntos</label>
                                                    <input [(ngModel)]="pregunta.points" type="number" min="0" class="form-control customInput w-25">
                                                </div>
                                            </div> -->
                                            <!-- <div fxLayout="row" fxLayoutAlign="start center" class="pdt10">
                                                <button (click)="questionImage.click()" class="grayButton pd03 radius4 ft12 h28px mgr10 gray-8" fxLayout="row" fxLayoutGap="0.625" fxLayoutAlign="center center">
                                                    <img [src]="icon.arrowUp" class="h16px pdr05" alt="">
                                                    Adjuntar imagen
                                                </button>
                                                <input #questionImage type="file" (change)="uploadQuestionImage($event,pregunta)" hidden accept="image/webp" />
                                            </div>
                                            <div *ngIf="pregunta.uploading_file_progress >0" class="form-group pdt10">
                                                <div fxLayout="column">
                                                    <div fxLayout="row" fxLayoutAlign="center center" class="w-25">
                                                        <mat-progress-bar class="h10px radius6 {{pregunta.uploading_file_progress >= 100? 'complete-progress-bar': ''}}" mode="determinate" [value]="pregunta.uploading_file_progress"></mat-progress-bar>
                                                        <span *ngIf="pregunta.uploading_file_progress < 100" class="pdl05">{{pregunta.uploading_file_progress}}%</span>
                                                        <img *ngIf="pregunta.uploading_file_progress>=100" [src]="icon.check" class="h16px pdl05" alt="">
                                                    </div>
                                                    <div fxLayout="row" *ngIf="pregunta.uploading_file_progress>=100" >
                                                        <span>{{pregunta.fileName}}&nbsp;</span>
                                                        <span (click)="pregunta['imageHidden'] =!pregunta['imageHidden'] " class="blueLink cursorPointer">{{ pregunta['imageHidden']? 'Ocultar archivo':'Ver archivo'}}</span>
                                                        <img (click)="deleteQuestionImage(pregunta,true)" [src]="icon.close" class="h18px pdr05 makeRed cursorPointer" alt="">
                                                     </div>
                                                    <div fxLayout="row" *ngIf="pregunta['imageHidden']" >
                                                        <img [src]="pregunta.image" style="max-height: 200px;">
                                                    </div>
                                                </div>
                                            </div>
                                            <div fxLayout="row">
                                                <div class="form-group pdt10 fw">
                                                    <textarea [(ngModel)]="pregunta.text" rows="3"  type="text" class="form-control customInput" placeholder="Escriba aqui la pregunta" style="resize: none;"></textarea>
                                                    <div class="invalid-feedback">
                                                        Debe indicar la pregunta.
                                                    </div>
                                                </div>
                                            </div>
                                            <div fxLayout="row" class="pdt05">
                                                <span [innerHTML]="questionInstruction(pregunta)"></span>
                                            </div> -->
                                            <div fxLayout="row" class="pdt05 fw">
                                                <!-- complete -->
                                                <!-- <div class="fw" fxLayout="column" *ngIf="pregunta.type.value == questionTypesIn.TYPE_COMPLETE_VALUE">
                                                    <div fxLayout="row" class="mgt10">
                                                        <span>Haga click en confirmar cuando haya terminado de escribir la pregunta</span>
                                                    </div>
                                                    <div fxLayout="row" class="pdt05 pdb05">
                                                        <button (click)="parseQuestionText(pregunta)" class="grayButton pd03 radius4 ft12 h28px mgr10 gray-8" fxLayout="row" fxLayoutGap="0.625" fxLayoutAlign="center center">
                                                            <img [src]="icon.check" class="h16px pdr05" alt="">
                                                            Confirmar
                                                        </button>
                                                    </div>
                                                    <div *ngFor="let placeHolder of pregunta.placeHolders; let i = index" class="ContainerModulo fw pd05">
            
                                                        <div fxLayout="row" fxLayoutAlign="start center">
                                                            {{i+1}}. {{placeHolder}}
                                                        </div>
                                                    
                                                        <div fxLayout="column">
                                                            <div fxLayout="row" class="pdb05">
                                                                <span class="gray-8 ft700">Opciones</span>
                                                            </div>
                                                            <div *ngFor="let option of pregunta.options; let optIndex = index" fxLayout="row">
        
                                                                <div *ngIf="option.placeholder == placeHolder" fxLayout="row" fxLayoutAlign="space-between center" class="fw pdb05">
        
                                                                    <input [(ngModel)]="option.text" type="text" class="form-control customInput w-40" placeholder="">
                                                                    <div fxLayout="row" fxLayoutAlign="center center" fxLayoutGap="5px">
                                                                        <input (change)="toggleOptionValue(pregunta,optIndex)" [checked]="option.isCorrect" type="checkbox" value="{{ optIndex }}"/>
                                                                        <img (click)="deleteOption(pregunta,optIndex)" [src]="icon.trash" class="h16px pdr05 cursorPointer trash pdl05" alt="">
                                                                    </div>
                    
                                                                </div>
                                                            
                                                            </div>
                                                            <div fxLayout="row">
                                                                <span (click)="addChoice(pregunta,placeHolder)" class="blueLink radius4 ft12 h28px no-select">
                                                                    <img [src]="icon.addNew" class="h12px pdr05 makeBlue" alt="">
                                                                    Agregar opción
                                                                </span>
                                                            </div>
                                                        </div>
                                                    </div>
                                                    <div *ngIf="pregunta.placeHolders?.length>0">
                                                        <button (click)="showDisplayText(pregunta)" class="grayButton pd03 radius4 ft12 h28px mgr10 gray-8" fxLayout="row" fxLayoutGap="0.625" fxLayoutAlign="center center">
                                                            <img [src]="icon.check" class="h16px pdr05" alt="">
                                                            Renderizar pregunta
                                                        </button>
                                                    </div>
                                                    <div class="gray-8 ft12 pdt10" [innerHTML]="pregunta.render" *ngIf="pregunta.render"></div>
                                                </div> -->
                                                <!-- multiple choice -->
                                                <!-- <div class="fw" fxLayout="column" *ngIf="pregunta.type.value == questionTypesIn.TYPE_MULTIPLE_CHOICE_VALUE">
                                                    <div *ngFor="let option of pregunta.options; let optIndex = index" fxLayout="row" class="fw">
                                                        <div fxLayout="row" fxLayoutAlign="space-between center" fxLayoutGap="1rem" class="mgb10 fw">
                                                    
                                                            <div fxLayout="row" fxLayoutAlign="start center" fxLayoutGap="5px">
                                                                <span class="gray-6">{{ optIndex + 1 }}.</span>
                                                                <input [(ngModel)]="option.text" type="text" class="form-control customInput" placeholder="">
                                                            </div>
                                                    
                                                            <div fxLayout="row" fxLayoutAlign="center center" fxLayoutGap="5px">
                                                                <input (change)="toggleOptionValue(pregunta,optIndex)" [checked]="option.isCorrect" type="checkbox" value="{{ optIndex }}"/>
                                                                <img (click)="deleteOption(pregunta,optIndex)" [src]="icon.trash" class="h16px pdr05 cursorPointer trash pdl05" alt="">
                                                            </div>
                                                        </div>
                                                    </div>
                                                    <div fxLayout="row">
                                                        <span (click)="addChoice(pregunta)" class="blueLink radius4 ft12 h28px no-select">
                                                            <img [src]="icon.addNew" class="h12px pdr05 makeBlue" alt="">
                                                            Agregar opción
                                                        </span>
                                                    </div>
                                                </div> -->
                                                <!-- single choice -->
                                                <!-- <div class="fw" fxLayout="column" *ngIf="pregunta.type.value == questionTypesIn.TYPE_SINGLE_CHOICE_VALUE">
                                                    <div *ngFor="let option of pregunta.options; let optIndex = index" fxLayout="row" class="fw">
                                                        <div fxLayout="row" fxLayoutAlign="space-between center" fxLayoutGap="1rem" class="mgb10 fw">
                                                            <div fxLayout="row" fxLayoutAlign="start center" fxLayoutGap="5px">
                                                                <span class="gray-6">{{ optIndex + 1 }}.</span>
                                                                <input [(ngModel)]="option.text" type="text" class="form-control customInput" placeholder="">
                                                            </div>
                                                    
                                                            <div fxLayout="row" fxLayoutAlign="center center" fxLayoutGap="5px">
                                                                <input [(ngModel)]="pregunta['correctOption']" name="radio" type="radio" (change)="changeCorrectOption(pregunta,optIndex)" [value]="optIndex"/>
                                                                <img (click)="deleteOption(pregunta,optIndex)" [src]="icon.trash" class="h16px pdr05 cursorPointer trash pdl05" alt="">
                                                            </div>
                                                        </div>
                                                    </div>
                                                    <div fxLayout="row">
                                                        <span (click)="addChoice(pregunta)" class="blueLink radius4 ft12 h28px no-select">
                                                            <img [src]="icon.addNew" class="h12px pdr05 makeBlue" alt="">
                                                            Agregar opción
                                                        </span>
                                                    </div>
                                                </div> -->
                                                <!-- true or false -->
                                                <!-- <div class="fw" fxLayout="column" *ngIf="pregunta.type.value == questionTypesIn.TYPE_TRUE_OR_FALSE_VALUE">
                                                    <div *ngFor="let option of pregunta.options; let optIndex = index" fxLayout="row" class="fw">
                                                        <div fxLayout="row" fxLayoutAlign="space-between center" fxLayoutGap="1rem" class="mgb10 fw">
                                                            <div fxLayout="row" fxLayoutAlign="start center" fxLayoutGap="5px">
                                                                <span class="gray-6">{{ optIndex + 1 }}.</span>
                                                                <input [(ngModel)]="option.text" type="text" class="form-control customInput" placeholder="">
                                                            </div>
                                                            <div fxLayout="row" fxLayoutAlign="center center" fxLayoutGap="5px">
                                                                <input (change)="toggleOptionValue(pregunta,optIndex)" [checked]="option.isCorrect" type="checkbox" value="{{ optIndex }}"/>
                                                                <img (click)="deleteOption(pregunta,optIndex)" [src]="icon.trash" class="h16px pdr05 cursorPointer trash pdl05" alt="">
                                                            </div>
                                                        </div>
                                                    </div>
                                                    <div fxLayout="row">
                                                        <span (click)="addChoice(pregunta)" class="blueLink radius4 ft12 h28px no-select">
                                                            <img [src]="icon.addNew" class="h12px pdr05 makeBlue" alt="">
                                                            Agregar opción
                                                        </span>
                                                    </div>
                                                </div> -->
                                            </div>
                                            <ng-container *ngIf="pregunta.isInvalid">
                                                <div fxLayout="row" *ngFor="let mensaje of pregunta.InvalidMessages" fxLayoutAlign="start center">
                                                    <mat-icon class="red-5 ft16">info</mat-icon>
                                                    <span class="redText">{{mensaje}}</span>
                                                </div>
                                            </ng-container>
                                        </div>
                                    </div>
                                </ng-container>
                                <app-questions  [nameCurso]="formNewCourse.get('titulo').value?  this.formNewCourse.get('titulo').value : 'Temporal'" [nameEmpresa]="empresa.name" (emmitForm)="validActividad = $event"  [heartsActivity]="selectedClase.tipo == 'corazones'? true: false" [questionsArray]="selectedClase?.activity?.questions ? selectedClase.activity.questions:[] " [checkQuestions]="updateTriggeQuestions" [selectedTestSkills]="competenciasSelectedClaseFormated"></app-questions>
                                <!-- <div fxLayout="row" class="fw">
                                    <div class="mgl40 mgr10 fw">
                                        <div class="fw mgb10">
                                            <span (click)="crearPreguntaActividad()" class="yellowLink radius4 ft12 h28px no-select" fxLayout="row" fxLayoutGap="0.625" fxLayoutAlign=" center">
                                                <img [src]="icon.addNew" class="h12px pdr05 makeYellow" alt="">
                                                Agregar pregunta
                                            </span>
                                        </div>
                                    </div>
                                </div> -->
                            </div>
                        </ng-container>
                        <!-- tab vista actividad -->
                        <ng-container *ngIf="activeStepActividad == 100">
                            <div fxFlex fxLayout="column" class="container pdl10 pdt10">
                                <ng-container>
                                    <!-- aqui van los preguntas que se van creando -->
                                    <div *ngFor="let question of selectedClase.activity.questions; let questionIndex = index" class="{{question.isInvalid?'ContainerModuloInvalid':'ContainerModulo'}}">
                                        <div fxLayout="row" fxLayoutAlign="space-between start" class="fw pd05 pdb0">
                                            <div fxLayout="row" fxLayoutGap="10px" class="fw">
                                                <div class="ft500 ft12">
                                                    <!-- numero pregunta -->
                                                    Pregunta {{questionIndex+1}}
                                                </div>
                                            </div>
                                        </div>
                                        <!-- Contenedor de las preguntas -->
                                        <div class="pd05">
                                            <div fxLayout="row" fxLayoutAlign="space-between center">
                                                <div fxLayout="row" fxLayoutGap="0.625">
                                                    <div class="pdr05">
                                                        {{ question.typeFormated.displayName }}
                                                    </div>
                                                </div>
                                                <div fxLayout="row" fxLayoutAlign="end center" fxLayoutGap="10px">
                                                    <label>Puntos:</label>
                                                    <span>{{question.points}}</span>
                                                </div>
                                            </div>
                                        
                                            <div fxLayout="row" class="pdt10">
                                                <!-- imagen -->
                                                <div *ngIf="question.image && !(question.image?.url)" fxFlex="30">
                                                    <img [src]="question.image" alt="" class="w-90" style="max-height: 200px;">
                                                </div>
    
                                                <!-- imagen -->
                                                <div *ngIf="question.image?.url" fxFlex="30">
                                                    <img [src]="question.image?.url" alt="" class="w-90" style="max-height: 200px;">
                                                </div>
                                                
                                                <!-- area dependiente de la pregunta -->
                                                <div fxFlex="70" fxLayout="column" class="pdt05 fw">
                                                    <div [innerHTML]="question.render" *ngIf="question.typeFormated.value == 'complete'">
                                                    </div>
                                        
                                                    <div *ngIf="question.typeFormated.value == 'single_choice'">
                                                        <span class="ft14 ft500"> {{ question.text }} </span>
                                                        <div class="mgt10" fxLayout="column">
                                                            <div fxLayout="row" fxLayoutAlign="space-between center" *ngFor="let option of question.options; let optionIndex = index" class="mgt05">
                                                                <span class="pdr05">{{ optionIndex + 1 }}. {{ option.text }}</span>
                                                                <input type="radio" [name]="questionIndex" />
                                                            </div>
                                                        </div>
                                                    </div>
                                        
                                                    <div *ngIf="question.typeFormated.value == 'multiple_choice'">
                                                        <span class="ft14 ft500"> {{ question.text }} </span>
                                                        <div class="mgt10" fxLayout="column">
                                                            <div fxLayout="row" fxLayoutAlign="space-between center" *ngFor="let option of question.options; let optionIndex = index" class="mgt05">
                                                                <span class="pdr05">{{ optionIndex + 1 }}. {{ option.text }}</span>
                                                                <input type="checkbox" />
                                                            </div>
                                                        </div>
                                                    </div>
                                        
                                                    <div *ngIf="question.typeFormated.value == 'true-false'">
                                                        <span class="ft14 ft500"> {{ question.text }} </span>
                                                        <div class="mgt10" fxLayout="column">
                                                            <div fxLayout="row" fxLayoutAlign="space-between center">
                                                                <span fxFlex="60" class="ft14 ft500">Enunciado</span>
                                                                <div class="centertext w200px">
                                                                    <span fxFlex="50" class="ft14 ft500">V</span>
                                                                    <span fxFlex="50" class="ft14 ft500">F</span>
                                                                </div>
                                                            </div>
                                                            <div fxLayout="row" fxLayoutAlign="space-between center" class="mgt05" *ngFor="let option of question.options; let optionIndex = index">
                                                                <div fxFlex="60" fxLayout="row" fxLayoutGap="1rem">
                                                                    <span>{{ optionIndex + 1 }}. {{ option.text }}</span>
                                                                </div>
                                                                <div class="centertext w200px">
                                                                    <input fxFlex="50" [name]="questionIndex.toString() + optionIndex.toString()" type="radio" [value]="true">
                                                                    <input fxFlex="50" [name]="questionIndex.toString() + optionIndex.toString()" type="radio" [value]="false" />
                                                                </div>
                                                            </div>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                        
                                        
                                    </div>
                                </ng-container>
                            </div>
                        </ng-container>
                    </div>
                </div>
                <div fxFlex="25%" fxLayout="column" fxLayoutAlign="center center">
                    <div *ngIf="viewVideoActivity" class="video-container-small">
                        <video #videoPlayerMini controls class="fw fh">
                            <!-- <source type="video/mp4" src="data:video/mp4;base64,{{selectedClase['base64Video']}}"> -->
                            <source [src]="selectedClase['base64Video']" type="video/mp4">
                        </video>
                    </div>
                    <div *ngIf="viewFileActivity" class="fw fh pdt10">
                        <ngx-extended-pdf-viewer *ngIf="viewFileActivity" [showToolbar]="false" [base64Src]="selectedClase?.archivos[0]?.base64" [useBrowserLocale]="true" height="90%"></ngx-extended-pdf-viewer>
                    </div>
                
                    <div *ngIf="!viewFileActivity && !viewVideoActivity" fxLayout="column" fxLayoutAlign="center center" class="fw fh">
                        <img  class="pd10" src="../../../assets/images/cursos/Next steps-pana.svg" class="fw" alt="Mi SVG">
                    </div>
                </div>
            </div>
            <div fxLayout="row" fxLayoutAlign="space-between center" class="mgt10">
                <!-- Botón a la izquierda -->
                <button  (click)="activeStepActividad >1 ? activeStepActividad = activeStepActividad-1 : modal.dismiss() " class="blueButton radius4 ft12 h28px mgr10 gray-1" fxLayout="row" fxLayoutGap="0.625" fxLayoutAlign="center center">
                    <img [src]="icon.chevronLeft" class="h16px pdr05 makeWhite" alt="">
                    Regresar
                </button>        
                <!-- Contenedor para los dos botones de la derecha -->
                <div fxLayout="row" fxLayoutGap="10px">               
                    <button *ngIf="activeStepActividad<=2" class="blueButton radius4 ft12 h28px mgr10 gray-1" (click)="advanceTabActividad();" fxLayout="row" fxLayoutGap="0.625" fxLayoutAlign="center center">
                        Continuar
                        <img [src]="icon.chevronRight" class="h16px pdl05 makeWhite" alt="">
                    </button>
                    <button (click)="modal.dismiss()" *ngIf="activeStepActividad==3" class="blueButton radius4 ft12 h28px mgr10 gray-1" fxLayout="row" fxLayoutGap="0.625" fxLayoutAlign="center center">
                        Continuar
                        <img [src]="icon.chevronRight" class="h16px pdl05 makeWhite" alt="">
                    </button>        
                </div>
            </div>
        </div>
    </ng-template>
    
    <!-- CLASE COMPETENCIAS MODAL -->
    <ng-template #modalAsignarCompetenciasClases let-modal>
        <div class="modal-header bg-web-primary text-white px-3 py-1">
            <div class="modal-title pd10" fxLayout="row" fxLayoutAlign="start center">
                <img [src]="icon.flash" class="h18px pdr05" alt="">
                <span class="ft16 ft600 gray-10">Asignar nuevas competencias</span>
            </div>
            <img style="cursor: pointer;" [src]="icon.close" (click)="modal.dismiss('Cross click')" class="h20px"  alt="">
        </div>
        <div class="modal-body">
            <div *ngIf="selectedClase.tipo == 'actividad'" fxLayout="row">
                <div class="fw pdl10 pdr10 pdt10">
                    <div class="fw">
                        <div class="stepper pdb10">
                            <div class="step" *ngFor="let item of stepsCompetencias; let i = index">
                                <div class= "no-select {{activeStepCompetencias == i+1? 'circleStepActive': 'circleStep'}} {{  activeStepCompetencias > i ? 'cursorPointer' : ''}}">{{ i + 1 }}</div>
                                <div (click)="activeStepCompetencias > i ? activeStepCompetencias=i+1 : '' " class="no-select {{activeStepCompetencias == i+1? 'titleActive ft400': 'title'}}  {{  activeStepCompetencias > i ? 'cursorPointer' : ''}}">{{ item }}</div>
                                <div class="mgr05" *ngIf="i < stepsCompetencias.length - 1">
                                    <img [src]="icon.chevronRight" class=" {{activeStepCompetencias == i+1? 'makeGray8': 'makeGray'}}" alt="">
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            <div fxLayout="column" class="fw pdt10">
                <ng-container *ngIf="activeStepCompetencias ==1">
                    <div *ngFor="let categoria of competenciasSelectedClase" fxLayout="column" class="fw pdb10">
                        <!-- Contenedor para la categoría y el ícono -->
                        <div fxLayout="row" class="category-container">
                            <span class="ft400 pdb03 flex-fill">
                                <!-- {{categoria|json}} -->
                                {{categoria.categoria?.name ? categoria.categoria.name: categoria.name | titlecase}}
                                ({{categoria.competencias.length}})
                            </span>
                            <!-- Asumiendo que deseas agregar un ícono aquí -->
                            <img *ngIf="categoria['expanded']" (click)="categoria['expanded'] = !categoria['expanded'];" [src]="icon.chevronUp" class="h16px pdr05 cursorPointer" alt="">
                            <img *ngIf="!categoria['expanded']" (click)="categoria['expanded'] = !categoria['expanded'];" [src]="icon.chevronDown" class="h16px pdr05 cursorPointer" alt="">
                        </div>
                        <!-- Displaying Chips -->
                        <mat-chip-listbox *ngIf="categoria['expanded']" selectable multiple aria-label="Fish selection" class="fw contenedor-chips pdt05" style="max-height: 100vh !important;">
                            <mat-chip-option class="custom-chip" *ngFor="let competencia of categoria.competencias" (click)="competencia.selected = !competencia.selected;getSelectedCategoriasCompetencias()" [selected]="competencia.selected">
                                {{competencia.name | titlecase}}
                                <img *ngIf="competencia.selected" [src]="icon.close" class="makeWhite h16px pdl05" alt="">
                                <img *ngIf="!competencia.selected" [src]="icon.addNew" class="makeGray h14px pdl05" alt="">
                            </mat-chip-option>
                        </mat-chip-listbox>
                    </div>
                </ng-container>
                <ng-container *ngIf="activeStepCompetencias == 2">
                    <!-- aqui van los preguntas que se van creando -->
                    <div *ngFor="let question of  selectedClase.activity.questions; let questionIndex = index" class="{{question['isInvalid']?'ContainerModuloInvalid':'ContainerModulo'}}">
                        <div fxLayout="row" fxLayoutAlign="space-between start" class="fw pd05 pdb0">
                            <div fxLayout="row" fxLayoutGap="10px" class="fw">
                                <div class="ft500 ft12">
                                    <!-- numero pregunta -->
                                    Pregunta {{questionIndex+1}}
                                </div>
                            </div>
                        </div>
                        <div fxLayout="row" fxLayoutAlign="space-between start" class="fw pd05 pdb10">
    
                            <div fxLayout="column" class="fw">
                                <!-- Contenedor para la categoría y el ícono -->
                                <div fxLayout="row" class="category-container">
                                    <span class="ft400 pdb03 flex-fill">
                                        Competencias
                                    </span>
                                    <!-- Asumiendo que deseas agregar un ícono aquí -->
                                    <img *ngIf="question['expanded_categorias']" (click)="question['expanded_categorias'] = !question['expanded_categorias'];" [src]="icon.chevronUp" class="h16px pdr05 cursorPointer" alt="">
                                    <img *ngIf="!question['expanded_categorias']" (click)="question['expanded_categorias'] = !question['expanded_categorias'];" [src]="icon.chevronDown" class="h16px pdr05 cursorPointer" alt="">
                                </div>
                            </div>
    
                        </div>
                        <!-- contenedor de competencias -->
                        <div *ngIf="question['expanded_categorias']" fxLayout="row" fxLayoutAlign="space-between start" class="fw pd05 pdb0">
                            <div fxLayout="column" class="fw pdl10">
                                <div *ngFor="let categoria of question['competencias_tmp']" fxLayout="column" class="fw pdb10">
                                    <!-- Contenedor para la categoría y el ícono -->
                                    <div fxLayout="row" class="category-container">
                                        <span class="ft400 pdb03 flex-fill">
                                            {{categoria.categoria?.name ? categoria.categoria.name: categoria.name | titlecase}}
                                            ({{categoria.competencias.length}})
                                        </span>
                                        <!-- Asumiendo que deseas agregar un ícono aquí -->
                                        <img *ngIf="categoria['expanded']" (click)="categoria['expanded'] = !categoria['expanded'];" [src]="icon.chevronUp" class="h16px pdr05 cursorPointer" alt="">
                                        <img *ngIf="!categoria['expanded']" (click)="categoria['expanded'] = !categoria['expanded'];" [src]="icon.chevronDown" class="h16px pdr05 cursorPointer" alt="">
                                    </div>
                                    <!-- Displaying Chips -->
                                    <mat-chip-listbox *ngIf="categoria['expanded']" selectable multiple aria-label="Fish selection" class="fw contenedor-chips pdt05" style="max-height: 100vh !important;">
                                        <mat-chip-option class="custom-chip" *ngFor="let competencia of categoria.competencias" (click)="competencia.selected = !competencia.selected;" [selected]="competencia.selected">
                                            {{competencia.name | titlecase}}
                                            <img *ngIf="competencia.selected" [src]="icon.close" class="makeWhite h16px pdl05" alt="">
                                            <img *ngIf="!competencia.selected" [src]="icon.addNew" class="makeGray h14px pdl05" alt="">
                                        </mat-chip-option>
                                    </mat-chip-listbox>
                                </div>
                            </div>
                        </div>
                        <!-- Contenedor de las preguntas -->
                        <div class="pd05">
                            <div fxLayout="row" fxLayoutAlign="space-between center">
                                <div fxLayout="row" fxLayoutGap="0.625">
                                    <div class="pdr05">
                                        {{ question.type.displayName }}
                                    </div>
                                </div>
                                <div fxLayout="row" fxLayoutAlign="end center" fxLayoutGap="10px">
                                    <label>Puntos:</label>
                                    <span>{{question.points}}</span>
                                </div>
                            </div>
                            <!-- imagen -->
                            <div fxLayout="row" fxLayoutAlign="start center" class="pdt10">
                                <img [src]="question.image" alt="" style="max-height: 200px;">
                            </div>
                            <!-- area dependiete de la pregunta -->
                            <div fxLayout="row" class="pdt05 fw">
                                <div [innerHTML] ="question['render']" *ngIf="question.type.value == 'complete'"></div>
                                <div *ngIf="question.type.value == 'single_choice'">
                                    <span class="ft14 ft500"> {{ question.text }} </span>
                                    <div class="mgt10" fxLayout="column">
                                        <div fxLayout="row" fxLayoutAlign="space-between center"
                                            *ngFor="let option of question.options; let optionIndex = index" class="mgt05">
                                            <span class="pdr05">{{ optionIndex + 1 }}. {{ option.text }}</span>
                                            <input type="radio" [name]="questionIndex" />
                                        </div>
                                    </div>
                                </div>
                                <div *ngIf="question.type.value == 'multiple_choice'">
                                    <span class="ft14 ft500"> {{ question.text }} </span>
                                    <div class="mgt10" fxLayout="column">
                                        <div fxLayout="row" fxLayoutAlign="space-between center" *ngFor="let option of question.options; let optionIndex = index" class="mgt05">
                                            <span class="pdr05" >{{ optionIndex + 1 }}. {{ option.text }}</span>
                                            <input type="checkbox"/>
                                        </div>
                                    </div>
                                </div>
                                <div *ngIf="question.type.value == 'true-false'">
                                    <span class="ft14 ft500"> {{ question.text }} </span>
                                    <div class="mgt10" fxLayout="column">
                                        <div fxLayout="row" fxLayoutAlign="space-between center">
                                            <span fxFlex="60" class="ft14 ft500">Enunciado</span>
                                            <div class="centertext w200px">
                                                <span fxFlex="50" class="ft14 ft500">V</span>
                                                <span fxFlex="50" class="ft14 ft500">F</span>
                                            </div>
                                        </div>
                                        <div fxLayout="row" fxLayoutAlign="space-between center" class="mgt05" *ngFor="let option of question.options; let optionIndex = index">
                                            <div fxFlex="60" fxLayout="row" fxLayoutGap="1rem">
                                                <span>{{ optionIndex + 1 }}. {{ option.text }}</span>
                                            </div>
                                            <div class="centertext w200px">
                                                <input fxFlex="50" [name]="questionIndex.toString() + optionIndex.toString()" type="radio" [value]="true">
                                                <input fxFlex="50" [name]="questionIndex.toString() + optionIndex.toString()" type="radio" [value]="false" />
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </ng-container>
            </div>
        </div>
        <div class="modal-footer">
            <button (click)="modal.dismiss()" class="grayButton pd03 radius4 ft12 h28px mgr10 gray-8" fxLayout="row" fxLayoutGap="0.625" fxLayoutAlign="center center">
                Cancelar
            </button>  
            <button *ngIf="selectedClase.tipo!='actividad'" (click)="saveCompetenciasClase()" class="blueButton radius4 ft12 h28px mgr10 gray-1" fxLayout="row" fxLayoutGap="0.625" fxLayoutAlign="center center">
                <img [src]="icon.save" class="h16px pdr05 makeWhite" alt="">
                Guadar
            </button>
            <ng-container *ngIf="selectedClase.tipo=='actividad'">
    
                <!-- <button *ngIf="activeStepCompetencias<2" class="blueButton radius4 ft12 h28px mgr10 gray-1" fxLayout="row" fxLayoutGap="0.625" fxLayoutAlign="center center">
                    <img [src]="icon.chevronRight" class="h16px pdr05 makeWhite" alt="">
                </button>    -->
                <button *ngIf="activeStepCompetencias<2" (click)="advanceTabCompetencia()"  class="blueButton radius4 ft12 h28px mgr10 gray-1" fxLayout="row" fxLayoutGap="0.625" fxLayoutAlign="center center">
                    Continuar
                    <img [src]="icon.chevronRight" class="h16px pdl05 makeWhite" alt="">
                </button>
                <!-- <button *ngIf="activeStepCompetencias==2" (click)="saveCompetenciasActividad()" class="blueButton radius4 ft12 h28px mgr10 gray-1" fxLayout="row" fxLayoutGap="0.625" fxLayoutAlign="center center">
                    <img [src]="icon.save" class="h16px pdr05 makeWhite" alt="">
                    Guadar
                </button> -->
            </ng-container>
        </div>
    </ng-template>
    
    <ng-template #modalCrearInstructor let-modal>
        <div class="modal-header bg-web-primary text-white px-3 py-1">
          <div class="modal-title pd10" fxLayout="row" fxLayoutAlign="start center">
            <span class="ft16 ft500 gray-10">Crear Instructor</span>
          </div>
          <img style="cursor: pointer;" [src]="icon.close" (click)="modal.dismiss('Cross click')" class="h20px" alt="">
        </div>
        <div class="modal-body" style="overflow-y: auto; max-height: 80vh;">
            <form [formGroup]="formNewInstructor" class="mgr20">
                <div class="form-group">
                    <label>Nombre del instructor</label>
                    <input formControlName="nombre" [class.is-invalid]="formNewInstructor.controls['nombre'].errors && showErrorInstructor" type="text" class="form-control customInput" placeholder="Escriba el nombre del instructor del diplomado aquí">
                    <div class="invalid-feedback" *ngIf="formNewInstructor.controls['nombre'].errors && showErrorInstructor"> 
                        Debe indicar el nombre del instructor.
                    </div>
                </div>
    
                <div class="form-group">
                    <label>Correo del instructor</label>
                    <input formControlName="email" [class.is-invalid]="formNewInstructor.controls['email'].errors && showErrorInstructor" type="text" class="form-control customInput" placeholder="Escriba el correo del instructor del diplomado aquí">
                    <div class="invalid-feedback" *ngIf="formNewInstructor.controls['email'].errors?.required && showErrorInstructor"> 
                        Debe indicar el correo del instructor.
                    </div>
                    <div class="invalid-feedback" *ngIf="formNewInstructor.controls['email'].errors?.email && showErrorInstructor"> 
                        El correo es invalido.
                    </div>
                </div>
    
    
                <div class="form-group pdt10">
                    <label>Resumen del instructor</label>
                    <textarea rows="3" [class.is-invalid]="formNewInstructor.controls['resumen'].errors && showErrorInstructor"  formControlName="resumen" type="text" class="form-control customInput" placeholder="Escriba el resumen del instructor aquí." style="resize: none;"></textarea>
                    <div class="invalid-feedback" *ngIf="formNewInstructor.controls['resumen'].errors && showErrorInstructor"> 
                        Debe indicar el resumen del instructor.
                    </div>
                </div>
                <div class="form-group pdt10">
                    <label>Foto del instructor</label>
                    <div class="avatar-selector">
                        <button (click)="instructorImage.click()" class="grayButton pd03 radius4 ft12 h28px mgr10 gray-8" fxLayout="row" fxLayoutGap="0.625" fxLayoutAlign="center center">
                            <img [src]="icon.arrowUp" class="h16px pdr05" alt="">
                            Adjuntar imagen
                        </button>
                        <input #instructorImage type="file" (change)="uploadCourseImage($event,'instructor',true)" hidden accept="image/jpeg, image/png" />
                        <div class="avatar-scroll">
                            <img *ngIf="formNewInstructor.get('foto').value" [src]="formNewInstructor.get('foto').value" alt="Imagen seleccionada" class="image shadow8">
                        </div>
                    </div>
                    <div *ngIf="formNewInstructor.controls['foto'].errors && showErrorInstructor" class="custom-invalid-feedback pdt05">
                        Debe seleccinar o subir la imagen del instructor
                    </div>
                </div>
            </form>
            <!-- Botón de guardar en la esquina inferior derecha -->
            <div fxLayout="row" fxLayoutAlign="end" class="pdt03">
                <button (click)="crearInstructor()" class="blueButton radius4 ft12 h28px mgr10 gray-1" fxLayout="row" fxLayoutGap="0.625" fxLayoutAlign="center center">
                    <img [src]="icon.save" class="h16px pdr05 makeWhite" alt="">
                    Guardar Instructor
                </button>
            </div>
        </div>
    </ng-template>
    <ng-template #modalSkillsCourse let-modal>
        <div class="modal-header bg-web-primary text-white px-3 py-1">
          <div class="modal-title pd10" fxLayout="row" fxLayoutAlign="start center">
            <span class="ft16 ft500 gray-10">Asignar competencias</span>
          </div>
          <img style="cursor: pointer;" [src]="icon.close" (click)="modal.dismiss('Cross click')" class="h20px" alt="">
        </div>
        <div class="modal-body" style="overflow-y: auto; max-height: 80vh;">
            {{pillarsForm.value['name']}}
            <div fxLayout="column">
                <div fxLayout="row">
                    <div class="skills-container">
                        <ng-container *ngFor="let skill of pillarsForm.value['competencias'] ? (pillarsForm.value['competencias'] | sortSkills:'name') : []; let indexSkill = index">
                            <div (click)="troggleSkill(skill)"
                                style="display: inline-block; margin-right: 5px; margin-bottom: 5px;"
                                class="skill-badge-complete  radius10 {{courseHasSkill(skill)?'ListHoverBlue gray-1':'ListHover2 gray-8'}} pdl05 pdr05 mgt05 no-select cursorPointer">
                                {{skill.name}}
                            </div>
                        </ng-container>
                        <div (click)="crearCompetencia(modalCrearSkill)" matTooltip="Crear competencia"
                            style="display: inline-block; margin-right: 5px; margin-bottom: 5px;" class="skill-badge ListHover2 radius10 backGray2 pdl05 pdr05 gray-8 mgt05">
                            +
                        </div>
                    </div>
                </div>
            </div>
            
    
            <!-- Botón de guardar en la esquina inferior derecha -->
            <div fxLayout="row" fxLayoutAlign="end" class="pdt03">
                <button (click)="saveNewSkills()" class="blueButton radius4 ft12 h28px mgr10 gray-1" fxLayout="row" fxLayoutGap="0.625" fxLayoutAlign="center center">
                    <img [src]="icon.save" class="h16px pdr05 makeWhite" alt="">
                    Confirmar
                </button>
            </div>
        </div>
    </ng-template>
    
    
    <ng-template #modalCrearSkill let-modal>
        <div class="modal-header bg-web-primary text-white px-3 py-1" fxLayout="row" fxLayoutAlign="space-between center">
            <div class="modal-title pd10">
              <span class="ft16 ft500 gray-10">Asignar Competencia</span>
            </div>
            <img style="cursor: pointer;" [src]="icon.close" (click)="modal.dismiss('Cross click')" class="h20px" alt="">
        </div>
        <div class="modal-body" style="overflow-y: auto; max-height: 80vh;">
            <form [formGroup]="formNewSkill" class="fw">
                <div fxLayout="row" class="fw">
                    <div class="form-group fw">
                        <label>Nombre de la competencia</label>
                        <input formControlName="nombre" [class.is-invalid]="formNewSkill.controls['nombre'].errors && showErrorSkill" type="text" class="form-control customInput" placeholder="Escriba el nombre de la competencia">
                        <div class="invalid-feedback" *ngIf="formNewSkill.controls['nombre'].errors && showErrorSkill">
                            Debe indicar el nombre de la competencia.
                        </div>
                    </div>
                </div>
            </form>
            <!-- Botón de guardar en la esquina inferior derecha -->
            <div fxLayout="row" fxLayoutAlign="end end" class="pdt03" style="width: 100%;">
                <button *ngIf="!savingSkill" (click)="saveNewSkill()" class="blueButton gray-1 radius4 ft12 h28px mgt10" fxLayout="row" fxLayoutGap="0.625rem" fxLayoutAlign="center center">
                    <img [src]="icon.check" class="h16px pdr05 makeWhite" alt="">
                    Asignar competencia
                </button>
                <button disabled *ngIf="savingSkill" (click)="saveNewSkill()" class="grayButton gray-8 radius4 ft12 h28px mgt10" fxLayout="row" fxLayoutGap="0.625rem" fxLayoutAlign="center center">
                    <mat-spinner class="spinner-dark" diameter="20"></mat-spinner>
                    Asignar competencia
                </button>
            </div>
        </div>
    </ng-template>
    <ng-template #modalCrearPilar let-modal>
        <div class="modal-header bg-web-primary text-white px-3 py-1">
          <div class="modal-title pd10" fxLayout="row" fxLayoutAlign="start center">
            <span class="ft16 ft500 gray-10">Crear Pilar</span>
          </div>
          <img style="cursor: pointer;" [src]="icon.close" (click)="modal.dismiss('Cross click')" class="h20px" alt="">
        </div>
        <div class="modal-body" style="overflow-y: auto; max-height: 80vh;">
    
    
            <form [formGroup]="formNewPillar" class="fw">
                <div fxLayout="row" class="fw">
                    <div class="form-group fw">
                        <label>Nombre del pilar</label>
                        <input formControlName="nombre" [class.is-invalid]="formNewPillar.controls['nombre'].errors && showErrorPillar" type="text" class="form-control customInput" placeholder="Escriba el nombre del pilar">
                        <div class="invalid-feedback" *ngIf="formNewPillar.controls['nombre'].errors && showErrorPillar"> 
                            Debe indicar el nombre del pilar.
                        </div>
                    </div>
                </div>
                <!-- <div fxLayout="row" class="fw" fxLayoutAlign="start center" fxLayoutGap="10px">
                    <div class="form-group" fxFlex>
                        <label>Agregar Competencia</label>
                        <input formControlName="skillTmp"  [class.is-invalid]="formNewPillar.controls['skillTmp'].errors && showErrorPillarSkill" type="text" class="form-control customInput" placeholder="Escriba de la competencia">
                    </div>
                    <div class="invalid-feedback" *ngIf="formNewPillar.controls['skillTmp'].errors && showErrorPillarSkill"> 
                        Debe indicar el nombre de la competencia.
                    </div>
                    <button (click)="addSkill()" class="blueButton radius4 ft12 h28px mgr10 gray-1 mgt15">
                        Agregar
                    </button>
                </div> -->
                <!-- <div>
                    <div class="skills-container">
                        <ng-container *ngFor="let skill of formNewPillar.get('skills')?.value; let indexSkill = index">
                            <div
                                style="display: inline-block; margin-right: 5px; margin-bottom: 5px;"
                                class="skill-badge-complete ListHover2 radius10 backGray2 pdl05 pdr05 gray-8 mgt05">
                                {{skill}}
                                <img (click)="removeSkillTmp(skill)" style="cursor: pointer;"  [src]="icon.close"  class="h16px"  alt="">
                            </div>
                        </ng-container>
                    </div>
                </div> -->
            </form>
    
    
            
            <!-- Botón de guardar en la esquina inferior derecha -->
            <div fxLayout="row" fxLayoutAlign="end" class="pdt03">
                <button (click)="!savingPillar?saveNewPillar():''" class="{{!savingPillar?'blueButton gray-1':'grayButton pd03 gray-8 '}} radius4 ft12 h28px mgt08" fxLayout="row" fxLayoutGap="0.625" fxLayoutAlign="center center">
                    <img [src]="icon.save" class="h16px = makeWhite" alt="">
                    Guardar Pilar
                </button>
            </div>
        </div>
    </ng-template>


</ng-container>



